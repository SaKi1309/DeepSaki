
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="DeepSaki - Deep Learning Extension for TensorFlow">
      
      
        <meta name="author" content="Sascha Kirch">
      
      
        <link rel="canonical" href="https://sascha-kirch.github.io/DeepSaki/develop/reference/DeepSaki/layers/">
      
      
        <link rel="prev" href="../initializers/">
      
      
        <link rel="next" href="../losses/">
      
      
      <link rel="icon" href="../../../assets/images/ds_logo_small.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>layers - DeepSaki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-HR2FT6EVBQ"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-HR2FT6EVBQ",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HR2FT6EVBQ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
<meta property="og:title" content="DeepSaki - Deep Learning Extension for TensorFlow" />
<meta property="og:description" content="DeepSaki is an add-on to TensorFlow. It provides a variaty of custom classes ranging from activation functions to entire models, helper functions to facilitate connectiong to your, compute HW and many more!" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://sascha-kirch.github.io/DeepSaki/develop/assets/images/social_card.png" />
<meta property="og:url" content="https://sascha-kirch.github.io/DeepSaki/develop/" />
<meta name="twitter:card" content="summary_large_image">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#DeepSaki.layers.fourier_layer.FFT2D" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="DeepSaki" class="md-header__button md-logo" aria-label="DeepSaki" data-md-component="logo">
      
  <img src="../../../assets/images/ds_logo_small_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DeepSaki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              layers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sascha-kirch/DeepSaki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sascha-kirch/DeepSaki
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Start

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../CONTRIBUTE/" class="md-tabs__link">
        
  
    
  
  Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../CHANGELOG/" class="md-tabs__link">
        
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="DeepSaki" class="md-nav__button md-logo" aria-label="DeepSaki" data-md-component="logo">
      
  <img src="../../../assets/images/ds_logo_small_white.png" alt="logo">

    </a>
    DeepSaki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sascha-kirch/DeepSaki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sascha-kirch/DeepSaki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DeepSaki
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            DeepSaki
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    activations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../augmentations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    augmentations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    initializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    layers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    layers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FFT2D" class="md-nav__link">
    FFT2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FFT3D" class="md-nav__link">
    FFT3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D" class="md-nav__link">
    FourierConvolution2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierFilter2D" class="md-nav__link">
    FourierFilter2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierLayer" class="md-nav__link">
    FourierLayer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierPooling2D" class="md-nav__link">
    FourierPooling2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.iFFT2D" class="md-nav__link">
    iFFT2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.iFFT3D" class="md-nav__link">
    iFFT3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.rFFT2DFilter" class="md-nav__link">
    rFFT2DFilter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.dropout_func" class="md-nav__link">
    dropout_func()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.get_initializer" class="md-nav__link">
    get_initializer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.pad_func" class="md-nav__link">
    pad_func()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.plot_layer" class="md-nav__link">
    plot_layer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Bottleneck" class="md-nav__link">
    Bottleneck
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Decoder" class="md-nav__link">
    Decoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Encoder" class="md-nav__link">
    Encoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.GlobalSumPooling2D" class="md-nav__link">
    GlobalSumPooling2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.LearnedPooling" class="md-nav__link">
    LearnedPooling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.padding.ReflectionPadding2D" class="md-nav__link">
    ReflectionPadding2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.Conv2DBlock" class="md-nav__link">
    Conv2DBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.Conv2DSplitted" class="md-nav__link">
    Conv2DSplitted
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.DenseBlock" class="md-nav__link">
    DenseBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.DownSampleBlock" class="md-nav__link">
    DownSampleBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResBlockDown" class="md-nav__link">
    ResBlockDown
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResBlockUp" class="md-nav__link">
    ResBlockUp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResidualBlock" class="md-nav__link">
    ResidualBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="md-nav__link">
    ScalarGatedSelfAttention
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ScaleLayer" class="md-nav__link">
    ScaleLayer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.UpSampleBlock" class="md-nav__link">
    UpSampleBlock
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    losses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../optimizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optimizers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>layers</h1>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FFT2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FFT2D</span>


<a href="#DeepSaki.layers.fourier_layer.FFT2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FFT2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Calculates the 2D descrete fourier transform over the 2 last dimensions.</p>
<p>For a 4D input of shape (batch, channel, height, width), the 2DFFT would be calculated over (height, width).</p>

<details class="know-what-to-expect" open>
  <summary>Know what to expect</summary>
  <table>
<thead>
<tr>
<th>input shape</th>
<th>input dtype</th>
<th style="text-align: center;">apply_real_fft</th>
<th style="text-align: right;">output dtype</th>
<th style="text-align: right;">output shape</th>
</tr>
</thead>
<tbody>
<tr>
<td>(1,8,8,3)</td>
<td>real</td>
<td style="text-align: center;">True</td>
<td style="text-align: right;">complex</td>
<td style="text-align: right;">(1,8,5,3)</td>
</tr>
<tr>
<td>(1,8,8,3)</td>
<td>real</td>
<td style="text-align: center;">false</td>
<td style="text-align: right;">n.a.</td>
<td style="text-align: right;">n.a.</td>
</tr>
<tr>
<td>(1,8,8,3)</td>
<td>complex</td>
<td style="text-align: center;">True(Value Error)</td>
<td style="text-align: right;">n.a.</td>
<td style="text-align: right;">n.a.</td>
</tr>
<tr>
<td>(1,8,8,3)</td>
<td>complex</td>
<td style="text-align: center;">False</td>
<td style="text-align: right;">complex</td>
<td style="text-align: right;">(1,8,8,3)</td>
</tr>
</tbody>
</table>
</details>
<details class="limitations" open>
  <summary>Limitations</summary>
  <p>Height and width are expected to be equal for now.</p>
</details>  
      <p>Initializes the <code>FFT2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_real_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rfft2D is applied, which assumes real valued inputs and halves the
width of the output(width/2+1 because center frequency is kept). If False, fft2D is applied, which
assumes complex input. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, low frequency components are centered. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>keyword arguments passed to the parent class tf.keras.layers.Layer.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `FFT2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        apply_real_fft (bool, optional): If True, rfft2D is applied, which assumes real valued inputs and halves the</span>
<span class="sd">            width of the output(width/2+1 because center frequency is kept). If False, fft2D is applied, which</span>
<span class="sd">            assumes complex input. Defaults to False.</span>
<span class="sd">        shift_fft (bool, optional): If true, low frequency components are centered. Defaults to True.</span>
<span class="sd">        kwargs (Any): keyword arguments passed to the parent class tf.keras.layers.Layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="n">apply_real_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span> <span class="o">=</span> <span class="n">shift_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">mixed_precision</span><span class="o">.</span><span class="n">global_policy</span><span class="p">()</span><span class="o">.</span><span class="n">compute_dtype</span>

    <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="k">else</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex64</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FFT2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FFT2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c) if <code>is_channel_first=False</code> or Tensor of shape (b,c,h,w) if
<code>is_channel_first=True</code>. <code>h</code> and <code>w</code> should be equal for now.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,Wo,c) if <code>is_channel_first=False</code> or  Tensor of shape (b,c,h,Wo) if
<code>is_channel_first=True</code>. If <code>apply_real_fft=True</code> <span class="arithmatex">\(Wo=\frac{w}{2}+1\)</span>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calls the `FFT2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c) if `is_channel_first=False` or Tensor of shape (b,c,h,w) if</span>
<span class="sd">            `is_channel_first=True`. `h` and `w` should be equal for now.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b,h,Wo,c) if `is_channel_first=False` or  Tensor of shape (b,c,h,Wo) if</span>
<span class="sd">            `is_channel_first=True`. If `apply_real_fft=True` $Wo=\frac{w}{2}+1$.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex128</span><span class="p">]:</span>
            <span class="n">imag</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">imag</span><span class="p">)</span>  <span class="c1"># fft2d requires complex inputs -&gt; create complex with 0 imaginary</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft2d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># reverse the channel configuration to its initial config</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FFT2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_real_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">,</span>
            <span class="s2">&quot;shift_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">,</span>
            <span class="s2">&quot;policy_compute_dtype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FFT3D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FFT3D</span>


<a href="#DeepSaki.layers.fourier_layer.FFT3D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FFT3D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Calculates the 3D descrete fourier transform over the 3 last dimensions.</p>
<p>For a 4D input like a batch of images of shape (batch, channel, height, width), the 3DFFT would be calculated over
(channel, height, width).
For a 5D input, like a batch of videos of shape (batch, channel, frame, height, width), the 3DFFT would be
calculated over (frame, height, width).</p>
  
      <p>Initializes the <code>FFT3D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) or (b,c,f,w,h) and false if input
shape is (b,h,w,c) or (b,f,w,h,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_real_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rfft3D is applied, which assumes real valued inputs and halves the
width of the output. If False, fft3D is applied, which assumes complex input. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, low frequency components are centered. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>keyword arguments passed to the parent class tf.keras.layers.Layer.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `FFT3D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) or (b,c,f,w,h) and false if input</span>
<span class="sd">            shape is (b,h,w,c) or (b,f,w,h,c). Defaults to `False`.</span>
<span class="sd">        apply_real_fft (bool, optional): If True, rfft3D is applied, which assumes real valued inputs and halves the</span>
<span class="sd">            width of the output. If False, fft3D is applied, which assumes complex input. Defaults to False.</span>
<span class="sd">        shift_fft (bool, optional): If true, low frequency components are centered. Defaults to True.</span>
<span class="sd">        kwargs (Any): keyword arguments passed to the parent class tf.keras.layers.Layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="n">apply_real_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span> <span class="o">=</span> <span class="n">shift_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">mixed_precision</span><span class="o">.</span><span class="n">global_policy</span><span class="p">()</span><span class="o">.</span><span class="n">compute_dtype</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="k">else</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex64</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">min_ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT3D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FFT3D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FFT3D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c) or (b,f,w,h,c) if <code>is_channel_first=False</code> or  Tensor of
shape (b,c,h,w) or (b,c,f,w,h) if <code>is_channel_first=True</code>. <code>h</code> and <code>w</code> should be equal for now.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,Wo,c) or (b,f,h,Wo,c) if <code>is_channel_first=False</code> or Tensor of shape (b,c,h,Wo) or
(b,f,c,h,Wo) if <code>is_channel_first=True</code>. If <code>apply_real_fft=True</code> <span class="arithmatex">\(Wo=\frac{w}{2}+1\)</span>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calls the `FFT3D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c) or (b,f,w,h,c) if `is_channel_first=False` or  Tensor of</span>
<span class="sd">            shape (b,c,h,w) or (b,c,f,w,h) if `is_channel_first=True`. `h` and `w` should be equal for now.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b,h,Wo,c) or (b,f,h,Wo,c) if `is_channel_first=False` or Tensor of shape (b,c,h,Wo) or</span>
<span class="sd">            (b,f,c,h,Wo) if `is_channel_first=True`. If `apply_real_fft=True` $Wo=\frac{w}{2}+1$.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft3d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">inputs</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex128</span><span class="p">]:</span>
            <span class="n">imag</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">imag</span><span class="p">)</span>  <span class="c1"># fft3d requires complex inputs -&gt; create complex with 0 imaginary</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fft3d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT3D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FFT3D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_real_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">,</span>
            <span class="s2">&quot;shift_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">,</span>
            <span class="s2">&quot;policy_compute_dtype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierConvolution2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierConvolution2D</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierConvolution2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_conjugate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pad_to_power_2</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">multiplication_type</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Performs a convolution by transforming into fourier domain. Layer input is asumed to be in spatial domain.</p>
  
      <p>Initialize the <code>FourierConvolution2D</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of individual filters. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[int, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel of the spatial convolution. Expected input
<code>[height,width]</code>. If <code>None</code>, kernel size is set to the input height and width. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to us bias weights. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_conjugate</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, the kernels are conjugated. If so, a multiplication in the
frequency domain corresponds to a cross correlation in the spatial domain, which is actually what a
convolution layer is doing. Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>pad_to_power_2</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, input tensor is padded. FFT algorithm runs faster for lengths of
power of two. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>multiplication_type</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.MultiplicationType" href="../types/#DeepSaki.types.layers_enums.MultiplicationType">MultiplicationType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of algo used for the element wise multiplication
and reduction of the input and the convolution kernel. [<code>MultiplicationType.ELEMENT_WISE</code> |
<code>MultiplicationType.MATRIX_PRODUCT</code>]. MATRIX_PRODUCT is faster, but requires more memory. ELEMENT_WISE
is slower but requires less memory. Defaults to <code>MultiplicationType.ELEMENT_WISE</code>.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.MultiplicationType" href="../types/#DeepSaki.types.layers_enums.MultiplicationType">MultiplicationType</a>.<span title="DeepSaki.types.layers_enums.MultiplicationType.ELEMENT_WISE">ELEMENT_WISE</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the kernels of
the convolution layer. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the bias weights
of the convolution layer. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_conjugate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pad_to_power_2</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">multiplication_type</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `FourierConvolution2D` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int, optional): Number of individual filters. Defaults to 3.</span>
<span class="sd">        kernels (Optional[Tuple[int, int]], optional): Kernel of the spatial convolution. Expected input</span>
<span class="sd">            `[height,width]`. If `None`, kernel size is set to the input height and width. Defaults to `None`.</span>
<span class="sd">        use_bias (bool, optional): Whether or not to us bias weights. Defaults to `True`.</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        apply_conjugate (bool, optional): If true, the kernels are conjugated. If so, a multiplication in the</span>
<span class="sd">            frequency domain corresponds to a cross correlation in the spatial domain, which is actually what a</span>
<span class="sd">            convolution layer is doing. Defaults to `False`.</span>
<span class="sd">        pad_to_power_2 (bool, optional): If true, input tensor is padded. FFT algorithm runs faster for lengths of</span>
<span class="sd">            power of two. Defaults to `True`.</span>
<span class="sd">        multiplication_type (MultiplicationType, optional): Type of algo used for the element wise multiplication</span>
<span class="sd">            and reduction of the input and the convolution kernel. [`MultiplicationType.ELEMENT_WISE` |</span>
<span class="sd">            `MultiplicationType.MATRIX_PRODUCT`]. MATRIX_PRODUCT is faster, but requires more memory. ELEMENT_WISE</span>
<span class="sd">            is slower but requires less memory. Defaults to `MultiplicationType.ELEMENT_WISE`.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the kernels of</span>
<span class="sd">            the convolution layer. Defaults to `None`.</span>
<span class="sd">        bias_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the bias weights</span>
<span class="sd">            of the convolution layer. Defaults to `None`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> <span class="k">if</span> <span class="n">kernel_initializer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kernel_initializer</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">()</span> <span class="k">if</span> <span class="n">bias_initializer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">bias_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span> <span class="o">=</span> <span class="n">apply_conjugate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span> <span class="o">=</span> <span class="n">pad_to_power_2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">multiplication_type</span> <span class="o">=</span> <span class="n">multiplication_type</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_multiplication_function</span><span class="p">(</span><span class="n">multiplication_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">)</span>

    <span class="c1"># weights are independent from batch size [out_filter,inp_filter,kernel,kernel]. I leave the two kernels last, since I then can easily calculate the 2d FFT at once!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_image_padding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bias&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FourierConvolution2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of data in spatial domain of shape <code>(b,h,w,c)</code> or <code>(b,c,h,w)</code> depending on
<code>is_channel_first</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor in spatial domain of same shape as input.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `FourierConvolution2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of data in spatial domain of shape `(b,h,w,c)` or `(b,c,h,w)` depending on</span>
<span class="sd">            `is_channel_first`</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor in spatial domain of same shape as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># FFT2D is calculated over last two dimensions!</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="c1"># Optionally pad to power of 2, to speed up FFT</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_image_shape_power_2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">)</span>

    <span class="c1"># Compute DFFTs for both inputs and kernel weights</span>
    <span class="n">inputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="p">)</span>  <span class="c1"># [batch,height,width,channel]</span>
    <span class="n">kernels_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span><span class="p">:</span>
        <span class="n">kernels_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">kernels_f_domain</span><span class="p">)</span>  <span class="c1"># to be equvivalent to the cross correlation</span>

    <span class="n">outputs_f_domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">inputs_f_domain</span><span class="p">,</span> <span class="n">kernels_f_domain</span><span class="p">)</span>

    <span class="c1"># Inverse rDFFT</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">irfft2d</span><span class="p">(</span><span class="n">outputs_f_domain</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="c1"># shift the samples to obtain linear conv from circular conv</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># obtain initial shape by removing padding</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span>
        <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Optionally add bias</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>

    <span class="c1"># reverse the channel configuration to its initial config</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_conjugate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span><span class="p">,</span>
            <span class="s2">&quot;pad_to_power_2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span><span class="p">,</span>
            <span class="s2">&quot;multiplication_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplication_type</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierFilter2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierFilter2D</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierFilter2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multiplication_type</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="n">filter_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Complex-valued learnable filter in frequency domain. Expects input data to be in the fourier domain.</p>
<p>The filter has the same size as the input and can hence act as any type of filter: low-pass, high-pass, band-pass,
band-stop or any combination.</p>
<p>To transform an image into the frequency domain you can use <code>DeepSaki.layers.FFT2D</code>.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">DeepSaki</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="c1"># pseudo code to load data</span>
<span class="n">image_dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FFT2D</span><span class="p">()(</span><span class="n">image_dataset</span><span class="p">)</span>
<span class="hll"><span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FourierFilter2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span><span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FourierFilter2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FourierFilter2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">128</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">iFFT2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
  
      <p>Initialize the <code>FourierFilter2D</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of independent filters. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to us bias weights. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>multiplication_type</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.MultiplicationType" href="../types/#DeepSaki.types.layers_enums.MultiplicationType">MultiplicationType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of algo used for the element wise multiplication
and reduction of the input and the filter weights. [<code>MultiplicationType.ELEMENT_WISE</code> |
<code>MultiplicationType.MATRIX_PRODUCT</code>]. MATRIX_PRODUCT is faster, but requires more memory. ELEMENT_WISE
is slower but requires less memory. Defaults to <code>MultiplicationType.ELEMENT_WISE</code>.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.MultiplicationType" href="../types/#DeepSaki.types.layers_enums.MultiplicationType">MultiplicationType</a>.<span title="DeepSaki.types.layers_enums.MultiplicationType.ELEMENT_WISE">ELEMENT_WISE</span></code>
          </td>
        </tr>
        <tr>
          <td><code>filter_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the wheights of
the filter layer. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the wheights of
the bias weights. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multiplication_type</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="n">filter_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `FourierFilter2D` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int, optional): Number of independent filters. Defaults to 3.</span>
<span class="sd">        use_bias (bool, optional): Whether or not to us bias weights. Defaults to `True`.</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        multiplication_type (MultiplicationType, optional): Type of algo used for the element wise multiplication</span>
<span class="sd">            and reduction of the input and the filter weights. [`MultiplicationType.ELEMENT_WISE` |</span>
<span class="sd">            `MultiplicationType.MATRIX_PRODUCT`]. MATRIX_PRODUCT is faster, but requires more memory. ELEMENT_WISE</span>
<span class="sd">            is slower but requires less memory. Defaults to `MultiplicationType.ELEMENT_WISE`.</span>
<span class="sd">        filter_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the wheights of</span>
<span class="sd">            the filter layer. Defaults to `None`.</span>
<span class="sd">        bias_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the wheights of</span>
<span class="sd">            the bias weights. Defaults to `None`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">multiplication_type</span> <span class="o">=</span> <span class="n">multiplication_type</span>

    <span class="n">filter_initializer</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> <span class="k">if</span> <span class="n">filter_initializer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">filter_initializer</span>
    <span class="p">)</span>
    <span class="n">bias_initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">()</span> <span class="k">if</span> <span class="n">bias_initializer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">bias_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span> <span class="o">=</span> <span class="n">ComplexInitializer</span><span class="p">(</span><span class="n">filter_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span> <span class="o">=</span> <span class="n">ComplexInitializer</span><span class="p">(</span><span class="n">bias_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_multiplication_function</span><span class="p">(</span><span class="n">multiplication_type</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fourier_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">],</span>
        <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fourier_bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bias&quot;</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FourierFilter2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Complex valued tensor of shape (b,h,w,c) if <code>is_channel_first=False</code> or Tensor of shape
(b,c,h,w) if <code>is_channel_first=True</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Complex valued tensor of shape (b,h,w,<code>filters</code>) if <code>is_channel_first=False</code> or Tensor of shape
(b,<code>filters</code>,h,w) if <code>is_channel_first=True</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `FourierFilter2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Complex valued tensor of shape (b,h,w,c) if `is_channel_first=False` or Tensor of shape</span>
<span class="sd">            (b,c,h,w) if `is_channel_first=True`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Complex valued tensor of shape (b,h,w,`filters`) if `is_channel_first=False` or Tensor of shape</span>
<span class="sd">            (b,`filters`,h,w) if `is_channel_first=True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># FFT2D is calculated over last two dimensions!</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier_filter</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier_bias</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># reverse the channel configuration to its initial config</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;filter_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span><span class="p">,</span>
            <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;multiplication_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplication_type</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierLayer</span>


<a href="#DeepSaki.layers.fourier_layer.FourierLayer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Base Class for Fourier Layers.</p>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierPooling2D</span>


<a href="#DeepSaki.layers.fourier_layer.FourierPooling2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierPooling2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">input_from_rfft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Pooling in frequency domain by truncating high frequencies using a center crop operation.</p>
<p>Layer input is asumed to be in frequency domain and shifted, such that the center frequency is in the center of
the grid.</p>
<p>If this is the case, the center represents the frequency of 0Hz (hence an offset). The further away from the center
the higher the frequency component. Center cropping removes high frequency components, hence can be seen as a low
pass filter</p>
  
      <p>Initializes an instance of <code>FourierPooling2D</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, input shape is assumed to be (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).
If False, input shape is assumed to be (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>). Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>input_from_rfft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, the input spectrum is assumed to be originated from an rFFT2D
operation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">input_from_rfft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes an instance of `FourierPooling2D`.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): If True, input shape is assumed to be (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">            If False, input shape is assumed to be (`batch`,`height`,`width`,`channel`). Defaults to False.</span>
<span class="sd">        input_from_rfft (bool, optional): If true, the input spectrum is assumed to be originated from an rFFT2D</span>
<span class="sd">            operation.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_from_rfft</span> <span class="o">=</span> <span class="n">input_from_rfft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierPooling2D.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.FourierPooling2D.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="n">offset_height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">offset_width</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_from_rfft</span> <span class="k">else</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">target_height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="c1"># + 1 is important. if real FFT width is usually odd.</span>
    <span class="n">target_width</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_begin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">offset_height</span><span class="p">,</span> <span class="n">offset_width</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_size</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">target_height</span><span class="p">,</span> <span class="n">target_width</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_begin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset_height</span><span class="p">,</span> <span class="n">offset_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_size</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target_height</span><span class="p">,</span> <span class="n">target_width</span><span class="p">,</span> <span class="n">channels</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierPooling2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FourierPooling2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FourierPooling2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Complex valued tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>). Tensor is asumed to be in frequency domain of type <code>tf.complex64</code>
or <code>tf.complex128</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pooled tensor of shape (<code>batch</code>,<code>channel</code>,<code>height/2</code>,<code>width/2</code>) or (<code>batch</code>,<code>height/2</code>,<code>width/2</code>,<code>channel</code>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `FourierPooling2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Complex valued tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`). Tensor is asumed to be in frequency domain of type `tf.complex64`</span>
<span class="sd">            or `tf.complex128`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Pooled tensor of shape (`batch`,`channel`,`height/2`,`width/2`) or (`batch`,`height/2`,`width/2`,`channel`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_begin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierPooling2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FourierPooling2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;input_from_rfft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_from_rfft</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.iFFT2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">iFFT2D</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">iFFT2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Calculates the 2D inverse FFT.</p>

<details class="know-what-to-expect" open>
  <summary>Know what to expect</summary>
  <table>
<thead>
<tr>
<th style="text-align: center;">apply_real_fft</th>
<th>input generated by</th>
<th>input shape</th>
<th>input dtype</th>
<th style="text-align: right;">output dtype</th>
<th style="text-align: right;">output shape</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">True</td>
<td>FFT2D(apply_real_fft=True)</td>
<td>(1,8,8,3)</td>
<td>complex</td>
<td style="text-align: right;">real</td>
<td style="text-align: right;">(1,8,5,3)</td>
</tr>
<tr>
<td style="text-align: center;">false</td>
<td>FFT2D(apply_real_fft=False)</td>
<td>(1,8,8,3)</td>
<td>complex</td>
<td style="text-align: right;">complex</td>
<td style="text-align: right;">(1,8,8,3)</td>
</tr>
</tbody>
</table>
</details>      <p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">DeepSaki</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">real_data</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="hll"><span class="n">complex_data</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span><span class="n">real_data</span><span class="p">)</span>
</span>
<span class="c1"># Real FFT with real valued data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)(</span><span class="n">real_data</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 33, 3), dtype=complex64&gt;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">iFFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 64, 3), dtype=float32&gt;</span>

<span class="c1"># Standard FFT with complex valued data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)(</span><span class="n">complex_data</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 64, 3), dtype=complex64&gt;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">iFFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 64, 3), dtype=complex64&gt;</span>

<span class="c1"># Standard FFT with real valued data - FFT2D will create a pseude complex tensor tf.complex(real, tf.zeros_like(real))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)(</span><span class="n">real_data</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 64, 3), dtype=complex64&gt;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">iFFT2D</span><span class="p">(</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#&lt;tf.Tensor: shape=(8, 64, 64, 3), dtype=complex64&gt;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># can be casted to real without issues, since imag values are all zero</span>
</code></pre></div></td></tr></table></div></p>
  
      <p>Initializes the <code>iFFT2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_real_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rfft2D is applied, which assumes real valued inputs and halves the
width of the output. If False, fft2D is applied, which assumes complex input. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, low frequency components are centered. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fft_length</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[int, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The FFT length for each dimension of the real FFT. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>keyword arguments passed to the parent class tf.keras.layers.Layer.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `iFFT2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        apply_real_fft (bool, optional): If True, rfft2D is applied, which assumes real valued inputs and halves the</span>
<span class="sd">            width of the output. If False, fft2D is applied, which assumes complex input. Defaults to False.</span>
<span class="sd">        shift_fft (bool, optional): If true, low frequency components are centered. Defaults to True.</span>
<span class="sd">        fft_length (Optional[Tuple[int,int]]): The FFT length for each dimension of the real FFT. Defaults to None.</span>
<span class="sd">        kwargs (Any): keyword arguments passed to the parent class tf.keras.layers.Layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">iFFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="n">apply_real_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span> <span class="o">=</span> <span class="n">shift_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span> <span class="o">=</span> <span class="n">fft_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.iFFT2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>iFFT2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Complex valued input Tensor. Shape depends on attributes <code>is_channel_first</code> and <code>apply_real_fft</code>. <br>
<code>is_channel_first=False</code>, <code>apply_real_fft=False</code>: Expected shape of input tensor: (b,h,w,c) <br>
<code>is_channel_first=True</code>, <code>apply_real_fft=False</code>: Expected shape of input tensor: (b,c,h,w) <br>
<code>is_channel_first=False</code>, <code>apply_real_fft=True</code>: Expected shape of input tensor: (b,h,w=h/2+1,c) <br>
<code>is_channel_first=True</code>, <code>apply_real_fft=True</code>: Expected shape of input tensor: (b,c,h,w=h/2+1)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape: <br>
<code>is_channel_first=False</code>: Expected shape of input tensor: (b,h,w=h,c) <br>
<code>is_channel_first=True</code>: Expected shape of input tensor: (b,c,h,w=h)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `iFFT2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Complex valued input Tensor. Shape depends on attributes `is_channel_first` and `apply_real_fft`. &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`, `apply_real_fft=False`: Expected shape of input tensor: (b,h,w,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`, `apply_real_fft=False`: Expected shape of input tensor: (b,c,h,w) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`, `apply_real_fft=True`: Expected shape of input tensor: (b,h,w=h/2+1,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`, `apply_real_fft=True`: Expected shape of input tensor: (b,c,h,w=h/2+1)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape: &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`: Expected shape of input tensor: (b,h,w=h,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`: Expected shape of input tensor: (b,c,h,w=h)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">irfft2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifft2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># reverse the channel configuration to its initial config</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.iFFT2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">iFFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_real_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">,</span>
            <span class="s2">&quot;shift_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">,</span>
            <span class="s2">&quot;fft_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.iFFT3D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">iFFT3D</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT3D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">iFFT3D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Calculates the 3D inverse FFT.</p>
  
      <p>Initializes the <code>iFFT3D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) or (b,c,f,h,w) and false if input
shape is (b,h,w,c) or (b,f,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_real_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, rfft3D is applied, which assumes real valued inputs and halves the
width of the output. If False, fft3D is applied, which assumes complex input. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>shift_fft</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, low frequency components are centered. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>fft_length</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[int, int, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The FFT length for each dimension of the real FFT. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>keyword arguments passed to the parent class tf.keras.layers.Layer.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_real_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shift_fft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fft_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `iFFT3D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) or (b,c,f,h,w) and false if input</span>
<span class="sd">            shape is (b,h,w,c) or (b,f,h,w,c). Defaults to `False`.</span>
<span class="sd">        apply_real_fft (bool, optional): If True, rfft3D is applied, which assumes real valued inputs and halves the</span>
<span class="sd">            width of the output. If False, fft3D is applied, which assumes complex input. Defaults to False.</span>
<span class="sd">        shift_fft (bool, optional): If true, low frequency components are centered. Defaults to True.</span>
<span class="sd">        fft_length (Optional[Tuple[int,int,int]]): The FFT length for each dimension of the real FFT. Defaults to None.</span>
<span class="sd">        kwargs (Any): keyword arguments passed to the parent class tf.keras.layers.Layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">iFFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span> <span class="o">=</span> <span class="n">apply_real_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span> <span class="o">=</span> <span class="n">shift_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span> <span class="o">=</span> <span class="n">fft_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">min_ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">complex64</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.iFFT3D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT3D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>iFFT3D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Complex valued input Tensor. Shape depends on attributes <code>is_channel_first</code> and <code>apply_real_fft</code>. <br>
<code>is_channel_first=False</code>, <code>apply_real_fft=False</code>: Expected shape of input tensor: (b,h,w,c) or (b,f,h,w,c) <br>
<code>is_channel_first=True</code>, <code>apply_real_fft=False</code>: Expected shape of input tensor: (b,c,h,w) or (b,c,f,h,w) <br>
<code>is_channel_first=False</code>, <code>apply_real_fft=True</code>: Expected shape of input tensor: (b,h,w=h/2+1,c) or (b,f,h,w=h/2+1,c) <br>
<code>is_channel_first=True</code>, <code>apply_real_fft=True</code>: Expected shape of input tensor: (b,c,h,w=h/2+1) or (b,c,f,h,w=h/2+1)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape: <br>
<code>is_channel_first=False</code>: Expected shape of input tensor: (b,h,w=h,c) or (b,f,h,w=h,c) <br>
<code>is_channel_first=True</code>: Expected shape of input tensor: (b,c,h,w=h) or (b,c,f,h,w=h)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `iFFT3D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Complex valued input Tensor. Shape depends on attributes `is_channel_first` and `apply_real_fft`. &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`, `apply_real_fft=False`: Expected shape of input tensor: (b,h,w,c) or (b,f,h,w,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`, `apply_real_fft=False`: Expected shape of input tensor: (b,c,h,w) or (b,c,f,h,w) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`, `apply_real_fft=True`: Expected shape of input tensor: (b,h,w=h/2+1,c) or (b,f,h,w=h/2+1,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`, `apply_real_fft=True`: Expected shape of input tensor: (b,c,h,w=h/2+1) or (b,c,f,h,w=h/2+1)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape: &lt;br&gt;</span>
<span class="sd">            `is_channel_first=False`: Expected shape of input tensor: (b,h,w=h,c) or (b,f,h,w=h,c) &lt;br&gt;</span>
<span class="sd">            `is_channel_first=True`: Expected shape of input tensor: (b,c,h,w=h) or (b,c,f,h,w=h)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_first</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">irfft3d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifft3d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_to_channel_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.iFFT3D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT3D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">iFFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_real_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_real_fft</span><span class="p">,</span>
            <span class="s2">&quot;shift_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">,</span>
            <span class="s2">&quot;fft_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft_length</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.rFFT2DFilter" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">rFFT2DFilter</span>


<a href="#DeepSaki.layers.fourier_layer.rFFT2DFilter" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">rFFT2DFilter</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filter_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">HIGH_PASS</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.FourierLayer" href="#DeepSaki.layers.fourier_layer.FourierLayer">FourierLayer</a></code></p>

  
      <p>Low or high pass filtering by truncating higher or lower frequencies in the frequency domain.</p>
<p>Layer input is asumed to be in spatial domain. It is transformed into the frequency domain applying a 2D real FFT.
Then the center-crop operation is performed and depending of the shift, either low or high frequencies are removed.
Afterwards, the cropped region is zero padded and then the inverse real 2D FFT is calculated to transform back into
the spatial domain.</p>
  
      <p>Initialize the <code>rFFT2DFilter</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, input shape is assumed to be (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).
If False, input shape is assumed to be (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>). Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>filter_type</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[Frequency_Filter.<span title="Frequency_Filter.LOW_PASS">LOW_PASS</span>, Frequency_Filter.<span title="Frequency_Filter.HIGH_PASS">HIGH_PASS</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If
<code>Frequency_Filter.LOW_PASS</code>, high frequency values are truncated, if <code>Frequency_Filter.HIGH_PASS</code>, low
frequencies are truncated. Defaults to <code>Frequency_Filter.LOW_PASS</code>.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.FrequencyFilter" href="../types/#DeepSaki.types.layers_enums.FrequencyFilter">FrequencyFilter</a>.<span title="DeepSaki.types.layers_enums.FrequencyFilter.LOW_PASS">LOW_PASS</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filter_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">HIGH_PASS</span><span class="p">]</span> <span class="o">=</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `rFFT2DFilter` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): If True, input shape is assumed to be (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">            If False, input shape is assumed to be (`batch`,`height`,`width`,`channel`). Defaults to False.</span>
<span class="sd">        filter_type (Literal[Frequency_Filter.LOW_PASS,Frequency_Filter.HIGH_PASS], optional): If</span>
<span class="sd">            `Frequency_Filter.LOW_PASS`, high frequency values are truncated, if `Frequency_Filter.HIGH_PASS`, low</span>
<span class="sd">            frequencies are truncated. Defaults to `Frequency_Filter.LOW_PASS`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">==</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.rFFT2DFilter.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.rFFT2DFilter.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rfft2d</span> <span class="o">=</span> <span class="n">FFT2D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="n">apply_real_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shift_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fourier_pooling_2d</span> <span class="o">=</span> <span class="n">FourierPooling2D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="n">input_from_rfft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">irfft2d</span> <span class="o">=</span> <span class="n">iFFT2D</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="n">apply_real_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shift_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shift_fft</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.rFFT2DFilter.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.rFFT2DFilter.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>rFFT2DFilter</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filtered tensor with shape (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `rFFT2DFilter` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Filtered tensor with shape (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier_pooling_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">irfft2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.rFFT2DFilter.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.rFFT2DFilter.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="s2">&quot;filter_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.dropout_func" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">dropout_func</span>


<a href="#DeepSaki.layers.layer_helper.dropout_func" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dropout_func</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to obtain a dropout layer depending on the number of filters of the preceeding feature map.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of filters of the preceeding layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer to drop weights.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>layer</code></td>          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Returns <code>tf.keras.layers.SpatialDropout2D</code> if number of filters &gt; 1, otherwise 'tf.keras.layers.Dropout'.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to obtain a dropout layer depending on the number of filters of the preceeding feature map.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int): Number of filters of the preceeding layer.</span>
<span class="sd">        dropout_rate (float): Probability of the dropout layer to drop weights.</span>

<span class="sd">    Returns:</span>
<span class="sd">        layer: Returns `tf.keras.layers.SpatialDropout2D` if number of filters &gt; 1, otherwise &#39;tf.keras.layers.Dropout&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;filters&#39; shall be of type int but is: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filters</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpatialDropout2D</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;provided value &#39;</span><span class="si">{</span><span class="n">filters</span><span class="si">}</span><span class="s2">&#39;for param &#39;filters&#39; is unvalid. Provide an int bigger than 0.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.get_initializer" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_initializer</span>


<a href="#DeepSaki.layers.layer_helper.get_initializer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_initializer</span><span class="p">(</span>
    <span class="n">initializer</span><span class="p">:</span> <span class="n">InitializerFunc</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to return a certain initializer given a descriptive string.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initializer</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.InitializerFunc" href="../types/#DeepSaki.types.layers_enums.InitializerFunc">InitializerFunc</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Enum description of the initializer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed to make the behavior of the initializer deterministic. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Instance of an initializer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_initializer</span><span class="p">(</span>
    <span class="n">initializer</span><span class="p">:</span> <span class="n">InitializerFunc</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to return a certain initializer given a descriptive string.</span>

<span class="sd">    Args:</span>
<span class="sd">        initializer (InitializerFunc): Enum description of the initializer.</span>
<span class="sd">        seed (Optional[int], optional): Seed to make the behavior of the initializer deterministic. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Instance of an initializer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">RANDOM_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomNormal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">RANDOM_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="n">minval</span><span class="o">=-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">GLOROT_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">GLOROT_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">HeNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">HeUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_ALPHA_NORMAL</span><span class="p">:</span> <span class="n">HeAlphaNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_ALPHA_UNIFORM</span><span class="p">:</span> <span class="n">HeAlphaUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">initializer</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_options</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Undefined initializer provided: &#39;</span><span class="si">{</span><span class="n">initializer</span><span class="si">}</span><span class="s2">&#39;. Valid options are: &#39;</span><span class="si">{</span><span class="n">valid_options</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">valid_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">initializer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.pad_func" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pad_func</span>


<a href="#DeepSaki.layers.layer_helper.pad_func" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">pad_func</span><span class="p">(</span>
    <span class="n">pad_values</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding_type</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to obtain a padding layer instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pad_values</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the padding values. Defaults to (1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>padding_type</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding Type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Instance of a padding layer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_func</span><span class="p">(</span>
    <span class="n">pad_values</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding_type</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to obtain a padding layer instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        pad_values (Tuple[int,int], optional): Size of the padding values. Defaults to (1, 1).</span>
<span class="sd">        padding_type (PaddingType, optional): Padding Type. Defaults to PaddingType.ZERO.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Instance of a padding layer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">PaddingType</span><span class="o">.</span><span class="n">REFLECTION</span><span class="p">:</span> <span class="n">ReflectionPadding2D</span><span class="p">(</span><span class="n">pad_values</span><span class="p">),</span>
        <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">ZeroPadding2D</span><span class="p">(</span><span class="n">pad_values</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">padding_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_options</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Undefined padding type provided: &#39;</span><span class="si">{</span><span class="n">padding_type</span><span class="si">}</span><span class="s2">&#39;. Valid options are: &#39;</span><span class="si">{</span><span class="n">valid_options</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">valid_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">padding_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.plot_layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">plot_layer</span>


<a href="#DeepSaki.layers.layer_helper.plot_layer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">plot_layer</span><span class="p">(</span>
    <span class="n">layer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Creates a model from a given layer to be able to call model.summary() and to plot a graph image.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>layer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Layer to be plotted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the desired input of the layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_layer</span><span class="p">(</span>
    <span class="n">layer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">,</span>
    <span class="n">input_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a model from a given layer to be able to call model.summary() and to plot a graph image.</span>

<span class="sd">    Args:</span>
<span class="sd">        layer (tf.keras.layers.Layer): Layer to be plotted.</span>
<span class="sd">        input_shape (List[int]): Shape of the desired input of the layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">input_shape</span><span class="p">])</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand_nested</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Bottleneck" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Bottleneck</span>


<a href="#DeepSaki.layers.sub_model_composites.Bottleneck" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Bottleneck</span><span class="p">(</span>
    <span class="n">n_bottleneck_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Bottlenecks are sub-model blocks in auto-encoder-like models such as UNet or ResNet.</p>
<p>It is composed of multiple convolution blocks which might have residuals.</p>
<p>Can be combined with <code>ds.layers.Encoder</code> and <code>ds.layers.Decoder</code> to form an auto encoder model.</p>

<details class="tipp" open>
  <summary>Tipp</summary>
  <p>Checkout the ds.models api to find models using this layer.</p>
</details>  
      <p>Initializes the <code>Bottleneck</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_bottleneck_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of consecutive blocks. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>split_kernels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>To decrease the number of parameters, a convolution with the kernel_size
<code>(kernel,kernel)</code> can be splitted into two consecutive convolutions with the kernel_size <code>(kernel,1)</code>
and <code>(1,kernel)</code> respectivly. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>: Number of consecutive conv layers within a basic building block.
Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>use_ResidualBlock</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to use the <code>ResidualBlock</code> instead of the
<code>Conv2DBlock</code>. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer. If the preceeding layer has more than one
channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.2.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_list</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alternativly to number_of_layers and filters, a list with the
disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level
Decoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>residual_cardinality</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cardinality for the <code>ResidualBlock</code>. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n_bottleneck_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `Bottleneck` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_bottleneck_blocks (int, optional): Number of consecutive blocks. Defaults to 3.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        split_kernels (bool, optional): To decrease the number of parameters, a convolution with the kernel_size</span>
<span class="sd">            `(kernel,kernel)` can be splitted into two consecutive convolutions with the kernel_size `(kernel,1)`</span>
<span class="sd">            and `(1,kernel)` respectivly. Defaults to False.</span>
<span class="sd">        number_of_blocks (int, optional): : Number of consecutive conv layers within a basic building block.</span>
<span class="sd">            Defaults to 2.</span>
<span class="sd">        use_ResidualBlock (bool, optional): Whether or not to use the `ResidualBlock` instead of the</span>
<span class="sd">            `Conv2DBlock`. Defaults to False.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer. If the preceeding layer has more than one</span>
<span class="sd">            channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.2.</span>
<span class="sd">        channel_list (Optional[List[int]], optional): Alternativly to number_of_layers and filters, a list with the</span>
<span class="sd">            disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level</span>
<span class="sd">            Decoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        residual_cardinality (int, optional): Cardinality for the `ResidualBlock`. Defaults to 1.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Bottleneck</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span> <span class="o">=</span> <span class="n">use_ResidualBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_bottleneck_blocks</span> <span class="o">=</span> <span class="n">n_bottleneck_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="n">channel_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Bottleneck.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.sub_model_composites.Bottleneck.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Bottleneck</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bottleneck_blocks</span><span class="p">)]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ResidualBlock</span><span class="p">(</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">residual_cardinality</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Bottleneck.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.sub_model_composites.Bottleneck.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>Bottleneck</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input tensor of shape (batch, height, width, channel)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (batch, height, width, channel)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `Bottleneck` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Input tensor of shape (batch, height, width, channel)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (batch, height, width, channel)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Bottleneck.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.sub_model_composites.Bottleneck.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Bottleneck</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;use_ResidualBlock&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">,</span>
            <span class="s2">&quot;n_bottleneck_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bottleneck_blocks</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;split_kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;channel_list&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">,</span>
            <span class="s2">&quot;residual_cardinality&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Decoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Decoder</span>


<a href="#DeepSaki.layers.sub_model_composites.Decoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Decoder</span><span class="p">(</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="n">UpSampleType</span> <span class="o">=</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">RESAMPLE_AND_CONV</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_self_attention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enable_skip_connections_input</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Combines conv blocks with up sample blocks.</p>
<p>The spatial width is doubled with every level while the channel depth is halfed.
Can be combined with <code>ds.layers.Encoder</code> and <code>ds.layers.Bottleneck</code> to form an auto encoder model.</p>

<details class="tipp" open>
  <summary>Tipp</summary>
  <p>Checkout the ds.models api to find models using this layer.</p>
</details>  
      <p>Initializes the <code>Decoder</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>number_of_levels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number levels in the decoder. Effectivly the number of convolution and
upsample pairs. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>upsampling</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.UpSampleType" href="../types/#DeepSaki.types.layers_enums.UpSampleType">UpSampleType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Describes the upsampling method used. Defaults to
UpSampleType.RESAMPLE_AND_CONV.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.UpSampleType" href="../types/#DeepSaki.types.layers_enums.UpSampleType">UpSampleType</a>.<span title="DeepSaki.types.layers_enums.UpSampleType.RESAMPLE_AND_CONV">RESAMPLE_AND_CONV</span></code>
          </td>
        </tr>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Base size of filters the is doubled with every level of the decoder.
Defaults to 64.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr>
          <td><code>limit_filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Limits the number of filters, which is doubled with every downsampling block.
Defaults to 512.</p>
            </div>
          </td>
          <td>
                <code>1024</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>split_kernels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>To decrease the number of parameters, a convolution with the kernel_size
<code>(kernel,kernel)</code> can be splitted into two consecutive convolutions with the kernel_size <code>(kernel,1)</code> and
<code>(1,kernel)</code> respectivly. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of consecutive convolutional building blocks, i.e. <code>Conv2DBlock</code>.
Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer. If the preceeding layer has more than one
channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.2.</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>use_ResidualBlock</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to use the <code>ResidualBlock</code> instead of the
<code>Conv2DBlock</code>. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>residual_cardinality</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cardinality for the <code>ResidualBlock</code>. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_list</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alternativly to number_of_layers and filters, a list with the
disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level
Decoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_self_attention</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to apply self-attention in the decoder. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>enable_skip_connections_input</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to input skip connections at each level. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="n">UpSampleType</span> <span class="o">=</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">RESAMPLE_AND_CONV</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_self_attention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enable_skip_connections_input</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `Decoder` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        number_of_levels (int, optional): Number levels in the decoder. Effectivly the number of convolution and</span>
<span class="sd">            upsample pairs. Defaults to 3.</span>
<span class="sd">        upsampling (UpSampleType, optional): Describes the upsampling method used. Defaults to</span>
<span class="sd">            UpSampleType.RESAMPLE_AND_CONV.</span>
<span class="sd">        filters (int, optional): Base size of filters the is doubled with every level of the decoder.</span>
<span class="sd">            Defaults to 64.</span>
<span class="sd">        limit_filters (int, optional): Limits the number of filters, which is doubled with every downsampling block.</span>
<span class="sd">            Defaults to 512.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        split_kernels (bool, optional): To decrease the number of parameters, a convolution with the kernel_size</span>
<span class="sd">            `(kernel,kernel)` can be splitted into two consecutive convolutions with the kernel_size `(kernel,1)` and</span>
<span class="sd">            `(1,kernel)` respectivly. Defaults to False.</span>
<span class="sd">        number_of_blocks (int, optional): Number of consecutive convolutional building blocks, i.e. `Conv2DBlock`.</span>
<span class="sd">            Defaults to 2.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer. If the preceeding layer has more than one</span>
<span class="sd">            channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.2.</span>
<span class="sd">        use_ResidualBlock (bool, optional): Whether or not to use the `ResidualBlock` instead of the</span>
<span class="sd">            `Conv2DBlock`. Defaults to False.</span>
<span class="sd">        residual_cardinality (int, optional): Cardinality for the `ResidualBlock`. Defaults to 1.</span>
<span class="sd">        channel_list (Optional[List[int]], optional): Alternativly to number_of_layers and filters, a list with the</span>
<span class="sd">            disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level</span>
<span class="sd">            Decoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        use_self_attention (bool, optional): Determines whether to apply self-attention in the decoder. Defaults to False.</span>
<span class="sd">        enable_skip_connections_input (bool, optional): Whether or not to input skip connections at each level. Defaults to False.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Decoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="n">number_of_levels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">=</span> <span class="n">upsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span> <span class="o">=</span> <span class="n">limit_filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span> <span class="o">=</span> <span class="n">use_ResidualBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="n">channel_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span> <span class="o">=</span> <span class="n">use_self_attention</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enable_skip_connections_input</span> <span class="o">=</span> <span class="n">enable_skip_connections_input</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Decoder.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.sub_model_composites.Decoder.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Decoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">))</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">decoderBlocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upSampleBlocks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="o">=</span> <span class="n">ScalarGatedSelfAttention</span><span class="p">(</span>
            <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="n">intermediate_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">):</span>
        <span class="n">dropout_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decoderBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ResidualBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">dropout_rate</span><span class="o">=</span><span class="n">dropout_rate</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">residual_cardinality</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upSampleBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ResBlockUp</span><span class="p">(</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decoderBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">dropout_rate</span><span class="o">=</span><span class="n">dropout_rate</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upSampleBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">UpSampleBlock</span><span class="p">(</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">upsampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Decoder.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.sub_model_composites.Decoder.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>Decoder</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>, <span title="typing.Tuple">Tuple</span>[<span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>, <span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>enable_skip_connections_input=False</code> only
inputs a tensor of shape (batch, height, width, min(channel<em>2</em>*level, limit_filters)). If
<code>enable_skip_connections_input=True</code>, additonally at every level of the decoder, skip connections from
an encoder can be inserted.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>tf.Tensor: Tensor of shape (<code>batch</code>, <code>height*2**number_of_levels</code>, <code>width*2**number_of_levels</code>,<code>filters</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `Decoder` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (Union[tf.Tensor , Tuple[tf.Tensor, tf.Tensor]]): If `enable_skip_connections_input=False` only</span>
<span class="sd">            inputs a tensor of shape (batch, height, width, min(channel*2**level, limit_filters)). If</span>
<span class="sd">            `enable_skip_connections_input=True`, additonally at every level of the decoder, skip connections from</span>
<span class="sd">            an encoder can be inserted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tf.Tensor: Tensor of shape (`batch`, `height*2**number_of_levels`, `width*2**number_of_levels`,`filters`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">skip_connections</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_skip_connections_input</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">skip_connections</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upSampleBlocks</span><span class="p">[</span><span class="n">level</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">skip_connections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">skip_connections</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">-</span> <span class="p">(</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoderBlocks</span><span class="p">[</span><span class="n">level</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Decoder.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.sub_model_composites.Decoder.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Decoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;number_of_levels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;limit_filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span><span class="p">,</span>
            <span class="s2">&quot;upsampling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;split_kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;use_ResidualBlock&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">,</span>
            <span class="s2">&quot;residual_cardinality&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
            <span class="s2">&quot;channel_list&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;use_self_attention&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span><span class="p">,</span>
            <span class="s2">&quot;enable_skip_connections_input&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">enable_skip_connections_input</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Encoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Encoder</span>


<a href="#DeepSaki.layers.sub_model_composites.Encoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Encoder</span><span class="p">(</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="n">DownSampleType</span> <span class="o">=</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">CONV_STRIDE_2</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">first_kernel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_self_attention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">omit_skips</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">output_skips</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Combines conv blocks with down sample blocks.</p>
<p>The spatial width is halved with every level while the channel depth is doubled.
Can be combined with <code>ds.layers.Decoder</code> and <code>ds.layers.Bottleneck</code> to form an auto encoder model.</p>

<details class="tipp" open>
  <summary>Tipp</summary>
  <p>Checkout the ds.models api to find models using this layer.</p>
</details>  
      <p>Initializes the <code>Encoder</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>number_of_levels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of downsampling levels of the model. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of filters for the initial encoder block. Defaults to 64.</p>
            </div>
          </td>
          <td>
                <code>64</code>
          </td>
        </tr>
        <tr>
          <td><code>limit_filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Limits the number of filters, which is doubled with every downsampling block.
Defaults to 1024.</p>
            </div>
          </td>
          <td>
                <code>1024</code>
          </td>
        </tr>
        <tr>
          <td><code>downsampling</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.DownSampleType" href="../types/#DeepSaki.types.layers_enums.DownSampleType">DownSampleType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Describes the downsampling method. Defaults to DownSampleType.CONV_STRIDE_2.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.DownSampleType" href="../types/#DeepSaki.types.layers_enums.DownSampleType">DownSampleType</a>.<span title="DeepSaki.types.layers_enums.DownSampleType.CONV_STRIDE_2">CONV_STRIDE_2</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>split_kernels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>To decrease the number of parameters, a convolution with the kernel_size
<code>(kernel,kernel)</code> can be splitted into two consecutive convolutions with the kernel_size <code>(kernel,1)</code> and
<code>(1,kernel)</code> respectivly. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of consecutive convolutional building blocks, i.e. <code>Conv2DBlock</code>.
Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>first_kernel</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first convolution can have a different kernel size, to e.g.
increase the perceptive field, while the channel depth is still low. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_ResidualBlock</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to use the <code>ResidualBlock</code> instead of the
<code>Conv2DBlock</code>. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>residual_cardinality</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Cardinality for the <code>ResidualBlock</code>. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>channel_list</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>alternativly to number_of_layers and filters, a list with the
disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level
Encoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer. If the preceeding layer has more than one
channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>use_self_attention</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Determines whether to apply self-attention in the encoder. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>omit_skips</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defines how many layers should not output a skip connection output. Requires
<code>output_skips</code> to be True. E.g. if <code>omit_skips = 2</code>, the first two levels do not output a skip connection,
it starts at level 3. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>output_skips</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, ski connections are output. Could be used to attach an encoder to a
decoder model. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="n">DownSampleType</span> <span class="o">=</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">CONV_STRIDE_2</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">first_kernel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_ResidualBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channel_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_self_attention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">omit_skips</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">output_skips</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `Encoder` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        number_of_levels (int, optional): Number of downsampling levels of the model. Defaults to 3.</span>
<span class="sd">        filters (int, optional): Number of filters for the initial encoder block. Defaults to 64.</span>
<span class="sd">        limit_filters (int, optional): Limits the number of filters, which is doubled with every downsampling block.</span>
<span class="sd">            Defaults to 1024.</span>
<span class="sd">        downsampling (DownSampleType, optional): Describes the downsampling method. Defaults to DownSampleType.CONV_STRIDE_2.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        split_kernels (bool, optional): To decrease the number of parameters, a convolution with the kernel_size</span>
<span class="sd">            `(kernel,kernel)` can be splitted into two consecutive convolutions with the kernel_size `(kernel,1)` and</span>
<span class="sd">            `(1,kernel)` respectivly. Defaults to False.</span>
<span class="sd">        number_of_blocks (int, optional): Number of consecutive convolutional building blocks, i.e. `Conv2DBlock`.</span>
<span class="sd">            Defaults to 2.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        first_kernel (Optional[int], optional): The first convolution can have a different kernel size, to e.g.</span>
<span class="sd">            increase the perceptive field, while the channel depth is still low. Defaults to None.</span>
<span class="sd">        use_ResidualBlock (bool, optional): Whether or not to use the `ResidualBlock` instead of the</span>
<span class="sd">            `Conv2DBlock`. Defaults to False.</span>
<span class="sd">        residual_cardinality (int, optional): Cardinality for the `ResidualBlock`. Defaults to 1.</span>
<span class="sd">        channel_list (Optional[List[int]], optional): alternativly to number_of_layers and filters, a list with the</span>
<span class="sd">            disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level</span>
<span class="sd">            Encoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly. Defaults to None.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer. If the preceeding layer has more than one</span>
<span class="sd">            channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</span>
<span class="sd">        use_self_attention (bool, optional): Determines whether to apply self-attention in the encoder. Defaults to False.</span>
<span class="sd">        omit_skips (int, optional): Defines how many layers should not output a skip connection output. Requires</span>
<span class="sd">            `output_skips` to be True. E.g. if `omit_skips = 2`, the first two levels do not output a skip connection,</span>
<span class="sd">            it starts at level 3. Defaults to 0.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        output_skips (bool, optional): If true, ski connections are output. Could be used to attach an encoder to a</span>
<span class="sd">            decoder model. Defaults to False.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="n">number_of_levels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span> <span class="o">=</span> <span class="n">limit_filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">=</span> <span class="n">downsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first_kernel</span> <span class="o">=</span> <span class="n">first_kernel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span> <span class="o">=</span> <span class="n">use_ResidualBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="n">channel_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span> <span class="o">=</span> <span class="n">use_self_attention</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">omit_skips</span> <span class="o">=</span> <span class="n">omit_skips</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">output_skips</span> <span class="o">=</span> <span class="n">output_skips</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Encoder.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.sub_model_composites.Encoder.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">encoderBlocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">downSampleBlocks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="o">=</span> <span class="n">ScalarGatedSelfAttention</span><span class="p">(</span>
            <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="n">intermediate_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">):</span>
        <span class="n">encoder_kernels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_kernel</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_kernel</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoderBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ResidualBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="n">encoder_kernels</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">dropout_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">residual_cardinality</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">downSampleBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ResBlockDown</span><span class="p">(</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoderBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">ch</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="n">encoder_kernels</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">dropout_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">downSampleBlocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">DownSampleBlock</span><span class="p">(</span>
                    <span class="n">downsampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="n">encoder_kernels</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Encoder.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.sub_model_composites.Encoder.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span>
    <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>Encoder</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input tensor of shape (batch, height, width, channel)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>, <span title="typing.Tuple">Tuple</span>[<span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>, <span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>output_skips=False</code> only the final output of the Encoder is returned as a tensor of shape
(<code>batch</code>, <code>height/2**number_of_levels</code>, <code>width/2**number_of_levels</code>,
<code>min(filters * 2 ** (number_of_levels - 1), limit_filters)</code>. If <code>output_skips=True</code> additionally returns
a tensor of tensor (one for each level of the encoder) of shape (<code>batch</code>, <code>height/2**level</code>,
<code>width/2**level</code>, <code>min(filters * 2 ** (number_of_levels - 1), limit_filters)</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `Encoder` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Input tensor of shape (batch, height, width, channel)</span>

<span class="sd">    Returns:</span>
<span class="sd">        If `output_skips=False` only the final output of the Encoder is returned as a tensor of shape</span>
<span class="sd">            (`batch`, `height/2**number_of_levels`, `width/2**number_of_levels`,</span>
<span class="sd">            `min(filters * 2 ** (number_of_levels - 1), limit_filters)`. If `output_skips=True` additionally returns</span>
<span class="sd">            a tensor of tensor (one for each level of the encoder) of shape (`batch`, `height/2**level`,</span>
<span class="sd">            `width/2**level`, `min(filters * 2 ** (number_of_levels - 1), limit_filters)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="n">skips</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SA</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoderBlocks</span><span class="p">[</span><span class="n">level</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">downSampleBlocks</span><span class="p">[</span><span class="n">level</span><span class="p">](</span><span class="n">skip</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_skips</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omit_skips</span><span class="p">:</span>  <span class="c1"># omit the first skip connection</span>
                <span class="n">skips</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skip</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">skips</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_skips</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">skips</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.sub_model_composites.Encoder.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.sub_model_composites.Encoder.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;number_of_levels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;limit_filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span><span class="p">,</span>
            <span class="s2">&quot;downsampling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;split_kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;first_kernel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_kernel</span><span class="p">,</span>
            <span class="s2">&quot;use_ResidualBlock&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ResidualBlock</span><span class="p">,</span>
            <span class="s2">&quot;residual_cardinality&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
            <span class="s2">&quot;channel_list&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_list</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;use_self_attention&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_self_attention</span><span class="p">,</span>
            <span class="s2">&quot;omit_skips&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">omit_skips</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;output_skips&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_skips</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.GlobalSumPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GlobalSumPooling2D</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">GlobalSumPooling2D</span><span class="p">(</span>
    <span class="n">data_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Global sum pooling operation for spatial data.</p>

<details class="tips" open>
  <summary>Tips</summary>
  <p>Similar to tensorflow's <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/GlobalMaxPooling2D">GlobalMaxPooling2D</a>
and <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/GlobalAveragePooling2D">GlobalAveragePooling2D</a></p>
</details>  
      <p>Initialize the <code>GlobalSumPooling2D</code> object.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>data_format</code> is not supported.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>["channels_last"|"data_format"]</p>
            </div>
          </td>
          <td>
                <code>&#39;channels_last&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `GlobalSumPooling2D` object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data_format` is not supported.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_format (str, optional): [&quot;channels_last&quot;|&quot;data_format&quot;]</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">GlobalSumPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">match</span> <span class="n">data_format</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;channels_last&quot;</span> <span class="o">|</span> <span class="s2">&quot;channels_first&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="n">data_format</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported channel configuration provided&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channel_axis</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_to_sum</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>GlobalSumPooling2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>channel</code>) where the elements are summed to reduce the axis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `GlobalSumPooling2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (`batch`,`channel`) where the elements are summed to reduce the axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">input_tensor</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_to_sum</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.compute_output_shape" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">compute_output_shape</span><span class="p">(</span>
    <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Computes the output shape of the layer.</p>
<p>This method will cause the layer's state to be built, if that has not happened before. This requires that the
layer will later be used with inputs that match the input shape provided here.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A TensorShape instance representing the shape of the layer's output Tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_output_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the output shape of the layer.</span>

<span class="sd">    This method will cause the layer&#39;s state to be built, if that has not happened before. This requires that the</span>
<span class="sd">    layer will later be used with inputs that match the input shape provided here.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A TensorShape instance representing the shape of the layer&#39;s output Tensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_shape</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">input_shape</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_axis</span><span class="p">]])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GlobalSumPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.LearnedPooling" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">LearnedPooling</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">LearnedPooling</span><span class="p">(</span><span class="n">pool_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Layer that learns a pooling operation.</p>
<p>Instead of using <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPooling2D">MaxPooling2D</a> or
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/AveragePooling2D">AveragePooling2D</a> the layer learns a
pooling operation.</p>

<details class="info" open>
  <summary>Info</summary>
  <p>Under the hood this layer simply performs a non-overlapping convolution operation.</p>
</details>  
      <p>Initializes an instance of <code>LearnedPooling</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the pooling window and the stride of the convolution operation. If the
input is of shape (b, h, w, c), the output is (b,h/pool_size,w/pool_size,c). Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes an instance of `LearnedPooling`.</span>

<span class="sd">    Args:</span>
<span class="sd">        pool_size (int, optional): Size of the pooling window and the stride of the convolution operation. If the</span>
<span class="sd">            input is of shape (b, h, w, c), the output is (b,h/pool_size,w/pool_size,c). Defaults to 2.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">LearnedPooling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span> <span class="o">=</span> <span class="n">pool_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pooling</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>LearnedPooling</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pooled tensor of shape (<code>batch</code>,<code>height/pool_size</code>,<code>width/pool_size</code>,<code>channel</code>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `LearnedPooling` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Pooled tensor of shape (`batch`,`height/pool_size`,`width/pool_size`,`channel`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pooling</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LearnedPooling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;pool_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.padding.ReflectionPadding2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ReflectionPadding2D</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ReflectionPadding2D</span><span class="p">(</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Reflection Padding layer with support for TPU.</p>

<details class="info" open>
  <summary>Info</summary>
  <p>At the time of implementation, Google's TPUs did not support gradient calculation of mirrored paddings like
"SYMMETRIC" and "REFLECTION". Therefore, a custom gradient needed to be calculated, by cropping the padding and
passing the gradients from the previous layer.</p>
</details>  
      <p>Initialize the <code>ReflectionPadding2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>One-sided padding added to the <code>hight</code> and <code>width</code> to an input tensor
of shape (batch, height, width, channel)respectively. Defaults to (1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `ReflectionPadding2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        padding (Tuple[int, int], optional): One-sided padding added to the `hight` and `width` to an input tensor</span>
<span class="sd">            of shape (batch, height, width, channel)respectively. Defaults to (1, 1).</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ReflectionPadding2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.padding.ReflectionPadding2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ReflectionPadding2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_tensor</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape <code>(batch, height, width, channel)</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>padded tensor of shape <code>(batch, height+2*padding, width+2*padding, channel)</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ReflectionPadding2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_tensor (tf.Tensor): Tensor of shape `(batch, height, width, channel)`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        padded tensor of shape `(batch, height+2*padding, width+2*padding, channel)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_padding_func</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.padding.ReflectionPadding2D.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D.compute_output_shape" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">compute_output_shape</span><span class="p">(</span>
    <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the expected output shape after calling the layer.</p>
<p>Assumes "channels_last" configuration.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input data to the layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>output_shape</code></td>          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>expected output shape of the layer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_output_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the expected output shape after calling the layer.</span>

<span class="sd">    Assumes &quot;channels_last&quot; configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input data to the layer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        output_shape: expected output shape of the layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">input_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">input_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.padding.ReflectionPadding2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReflectionPadding2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.Conv2DBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Conv2DBlock</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Conv2DBlock</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Wraps a two-dimensional convolution into a more complex building block.</p>
  
      <p>Initializes the <code>Conv2DBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of individual filters. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>split_kernels</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>To decrease the number of parameters, a convolution with the kernel_size
<code>(kernel,kernel)</code> can be splitted into two consecutive convolutions with the kernel_size <code>(kernel,1)</code>
and <code>(1,kernel)</code> respectivly. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of consecutive convolutional building blocks, i.e. <code>Conv2DBlock</code>.
Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer. If the preceeding layer has more than one
channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>final_activation</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to activate the output of this layer. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stride of the filter. Defaults to (1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>apply_final_normalization</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to place a normalization on the layer's output.
Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `Conv2DBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int, optional): Number of individual filters. Defaults to 3.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        split_kernels (bool, optional): To decrease the number of parameters, a convolution with the kernel_size</span>
<span class="sd">            `(kernel,kernel)` can be splitted into two consecutive convolutions with the kernel_size `(kernel,1)`</span>
<span class="sd">            and `(1,kernel)` respectivly. Defaults to False.</span>
<span class="sd">        number_of_blocks (int, optional): Number of consecutive convolutional building blocks, i.e. `Conv2DBlock`.</span>
<span class="sd">            Defaults to 1.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer. If the preceeding layer has more than one</span>
<span class="sd">            channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</span>
<span class="sd">        final_activation (bool, optional): Whether or not to activate the output of this layer. Defaults to True.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        strides (Tuple[int, int], optional): Stride of the filter. Defaults to (1, 1).</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        apply_final_normalization (bool, optional): Whether or not to place a normalization on the layer&#39;s output.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span> <span class="o">=</span> <span class="n">final_activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span> <span class="o">=</span> <span class="n">apply_final_normalization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">pad</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># assumes odd kernel size, which is typical!</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_blocks</span><span class="p">):</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pad</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">!=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pad_func</span><span class="p">(</span><span class="n">pad_values</span><span class="o">=</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">pad</span><span class="p">),</span> <span class="n">padding_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">))</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_conv_layer</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">block</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InstanceNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">))</span>  <span class="c1">#</span>

        <span class="k">if</span> <span class="n">block</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.Conv2DBlock.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DBlock.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>Conv2DBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b, h, w, c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b, h/(<code>strides[0]</code><strong><code>number_of_blocks</code>), w/(<code>strides[1]</code></strong><code>number_of_blocks</code>), <code>filters</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `Conv2DBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b, h, w, c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b, h/(`strides[0]`**`number_of_blocks`), w/(`strides[1]`**`number_of_blocks`), `filters`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.Conv2DBlock.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DBlock.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;split_kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;final_activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;strides&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">strides</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;apply_final_normalization&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.Conv2DSplitted" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Conv2DSplitted</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DSplitted" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Conv2DSplitted</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Convolution layer where a single convolution is splitted into two consecutive convolutions.</p>
<p>To decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two
consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly.</p>
  
      <p>Initialize the <code>Conv2DSplitted</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of filters in the output feature map. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions' kernels, which will be translated to (kernels, 1) and
(1,kernels) for the first and seccond convolution respectivly. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>strides</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Strides of the convolution layers. Defaults to (1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to use bias weights. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>["valid"|"same"]</p>
            </div>
          </td>
          <td>
                <code>&#39;valid&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions
kernels. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `Conv2DSplitted` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int, optional): Number of filters in the output feature map. Defaults to 3.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions&#39; kernels, which will be translated to (kernels, 1) and</span>
<span class="sd">            (1,kernels) for the first and seccond convolution respectivly. Defaults to 3.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        strides (Tuple[int, int], optional): Strides of the convolution layers. Defaults to (1, 1).</span>
<span class="sd">        use_bias (bool, optional): Whether or not to use bias weights. Defaults to True.</span>
<span class="sd">        padding (str, optional): [&quot;valid&quot;|&quot;same&quot;]</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions</span>
<span class="sd">            kernels. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DSplitted</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="n">kernels</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="n">strides</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernels</span><span class="p">),</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">strides</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">use_spec_norm</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.Conv2DSplitted.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DSplitted.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>Conv2DSplitted</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape <code>(batch, height, width, channel)</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Convoluted tensor of shape <code>(batch, H, W, filters)</code>, where <code>H</code> and <code>W</code> depend on the padding type used in
the convolution layers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `Conv2DSplitted` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape `(batch, height, width, channel)`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Convoluted tensor of shape `(batch, H, W, filters)`, where `H` and `W` depend on the padding type used in</span>
<span class="sd">            the convolution layers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.Conv2DSplitted.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DSplitted.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DSplitted</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;strides&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">strides</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.DenseBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DenseBlock</span>


<a href="#DeepSaki.layers.layer_composites.DenseBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DenseBlock</span><span class="p">(</span>
    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Wraps a dense layer into a more complex building block.</p>
  
      <p>Initializes the <code>DenseBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>units</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of units of each dense block</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of consecutive subblocks. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal to obtain activation function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer dropping weights. If the preceeding layer
has more than one channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>final_activation</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to activate the output of this layer. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to dense layers. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_final_normalization</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to apply normalization at the layer's output.
Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether dense layers include bias weights. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `DenseBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        units (int): Number of units of each dense block</span>
<span class="sd">        number_of_blocks (int, optional): Number of consecutive subblocks. Defaults to 1.</span>
<span class="sd">        activation (str, optional): String literal to obtain activation function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer dropping weights. If the preceeding layer</span>
<span class="sd">            has more than one channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</span>
<span class="sd">        final_activation (bool, optional): Whether or not to activate the output of this layer. Defaults to True.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to dense layers. Defaults to False.</span>
<span class="sd">        apply_final_normalization (bool, optional): Whether or not to apply normalization at the layer&#39;s output.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        use_bias (bool, optional): Whether dense layers include bias weights. Defaults to True.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DenseBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span> <span class="o">=</span> <span class="n">final_activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span> <span class="o">=</span> <span class="n">apply_final_normalization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">min_ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_blocks</span><span class="p">):</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_dense_layer</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">block</span> <span class="o">!=</span> <span class="p">(</span><span class="n">number_of_blocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InstanceNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">block</span> <span class="o">!=</span> <span class="p">(</span><span class="n">number_of_blocks</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.DenseBlock.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.DenseBlock.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>DenseBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b, h, w, c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b, h, w, <code>units</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `DenseBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b, h, w, c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b, h, w, `units`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.DenseBlock.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.DenseBlock.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DenseBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;final_activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;apply_final_normalization&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.DownSampleBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DownSampleBlock</span>


<a href="#DeepSaki.layers.layer_composites.DownSampleBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DownSampleBlock</span><span class="p">(</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="n">DownSampleType</span> <span class="o">=</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">AVG_POOLING</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial down-sampling for grid-like data using <code>DeepSaki.layers.ConvBlock2D()</code>.</p>
  
      <p>Initializes the <code>DownSampleBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>downsampling</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.DownSampleType" href="../types/#DeepSaki.types.layers_enums.DownSampleType">DownSampleType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Downsampling method used. Defaults to DownSampleType.AVG_POOLING.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.DownSampleType" href="../types/#DeepSaki.types.layers_enums.DownSampleType">DownSampleType</a>.<span title="DeepSaki.types.layers_enums.DownSampleType.AVG_POOLING">AVG_POOLING</span></code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="n">DownSampleType</span> <span class="o">=</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">AVG_POOLING</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `DownSampleBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        downsampling (DownSampleType, optional): Downsampling method used. Defaults to DownSampleType.AVG_POOLING.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DownSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">=</span> <span class="n">downsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.DownSampleBlock.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.DownSampleBlock.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if unsupported downsampling is provided.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if unsupported downsampling is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DownSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">==</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">CONV_STRIDE_2</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Conv2DBlock</span><span class="p">(</span>
                <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
                <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">==</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">MAX_POOLING</span><span class="p">:</span>
        <span class="c1"># Only spatial downsampling, increase in features is done by the conv2D_block specified later!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">==</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">AVG_POOLING</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">AveragePooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">==</span> <span class="n">DownSampleType</span><span class="o">.</span><span class="n">SPACE_TO_DEPTH</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_space_to_depth_block_size_2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
                <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Undefined downsampling provided&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.DownSampleBlock.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.DownSampleBlock.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>DownSampleBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spatially downsampled tensor of shape (b,h/2,w/2,c)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `DownSampleBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spatially downsampled tensor of shape (b,h/2,w/2,c)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.DownSampleBlock.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.DownSampleBlock.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">DownSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;downsampling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResBlockDown" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResBlockDown</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockDown" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResBlockDown</span><span class="p">(</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial down-sampling with residual connection for grid-like data using <code>DeepSaki.layers.ConvBlock2D()</code>.</p>

<details class="architecture" open>
  <summary>Architecture</summary>
  <pre class="mermaid"><code>flowchart LR
    i([input_tensor])--&gt; c1 &amp; c2
    subgraph ResBlockDown
        subgraph Block[2x]
        c1[ds.layers.Conv2DBlock]
        end
        c1--&gt;ap1[AveragePooling2D]
        c2[ds.layers.Conv2DBlock]--&gt;ap2[AveragePooling2D]
        ap1 &amp; ap2--&gt;add((+))
    end
    add--&gt;o([output_tensor])</code></pre>
</details>  
      <p>Initializes the <code>ResBlockDown</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `ResBlockDown` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockDown</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockDown.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockDown.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockDown</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">convRes</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockDown.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockDown.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ResBlockDown</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spatially downsampled tensor of shape (b,h/2,w/2,c)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ResBlockDown` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spatially downsampled tensor of shape (b,h/2,w/2,c)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path1</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="n">path1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convRes</span><span class="p">(</span><span class="n">path1</span><span class="p">)</span>
    <span class="n">path1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">AveragePooling2D</span><span class="p">()(</span><span class="n">path1</span><span class="p">)</span>

    <span class="n">path2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">AveragePooling2D</span><span class="p">()(</span><span class="n">path2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">()([</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockDown.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockDown.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockDown</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResBlockUp" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResBlockUp</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockUp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResBlockUp</span><span class="p">(</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial up-sampling with residual connection for grid-like data using <code>DeepSaki.layers.ConvBlock2D()</code>.</p>

<details class="architecture" open>
  <summary>Architecture</summary>
  <pre class="mermaid"><code>flowchart LR
    i([input_tensor])--&gt;up1 &amp; up2
    subgraph ResBlockUp
        up1[UpSample2D]--&gt;c1
        subgraph Block[2x]
        c1[ds.layers.Conv2DBlock]
        end
        up2[UpSample2D]--&gt;c2[ds.layers.Conv2DBlock]
        c1 &amp; c2--&gt;add((+))
    end
    add--&gt;o([output_tensor])</code></pre>
</details>  
      <p>Initializes the <code>ResBlockUp</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `ResBlockUp` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockUp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockUp.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockUp.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockUp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">convRes</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">kernels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockUp.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockUp.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ResBlockUp</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h<em>2,w</em>2,c)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ResBlockUp` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b,h*2,w*2,c)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path1</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="n">path1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">UpSampling2D</span><span class="p">()(</span><span class="n">path1</span><span class="p">)</span>
    <span class="n">path1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convRes</span><span class="p">(</span><span class="n">path1</span><span class="p">)</span>

    <span class="n">path2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">UpSampling2D</span><span class="p">()(</span><span class="n">path2</span><span class="p">)</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>
    <span class="n">path2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">path2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">()([</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResBlockUp.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockUp.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockUp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResidualBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResidualBlock</span>


<a href="#DeepSaki.layers.layer_composites.ResidualBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResidualBlock</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Residual block with configurable cardinality.</p>
  
      <p>Initializes the <code>ResidualBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of individual filters. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>number_of_blocks</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of residual subblocks. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>residual_cardinality</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of parallel paths. Defaults to 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>dropout_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability of the dropout layer. If the preceeding layer has more than one
channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">number_of_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `ResidualBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int, optional): Number of individual filters. Defaults to 3.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        number_of_blocks (int, optional): Number of residual subblocks. Defaults to 1.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        residual_cardinality (int, optional): Number of parallel paths. Defaults to 1.</span>
<span class="sd">        dropout_rate (float, optional): Probability of the dropout layer. If the preceeding layer has more than one</span>
<span class="sd">            channel, spatial dropout is applied, otherwise standard dropout. Defaults to 0.0.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResidualBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span> <span class="o">=</span> <span class="n">number_of_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">kernels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># assumes odd kernel size, which is typical!</span>

    <span class="k">if</span> <span class="n">residual_cardinality</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">filters</span> <span class="o">/</span> <span class="mi">32</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">16</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">filters</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># for each block, add several con</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_blocks</span><span class="p">):</span>
        <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="n">PaddingType</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">Conv2DBlock</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
                    <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                    <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">residual_cardinality</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cardinals</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResidualBlock.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.ResidualBlock.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResidualBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv0</span> <span class="o">=</span> <span class="n">Conv2DBlock</span><span class="p">(</span>
            <span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResidualBlock.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.ResidualBlock.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ResidualBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (batch, height, width, channel)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (batch, height, width, <code>filters</code>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ResidualBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (batch, height, width, channel)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (batch, height, width, `filters`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">):</span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">x</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">!=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">NONE</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">pad_func</span><span class="p">(</span><span class="n">pad_values</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span><span class="p">),</span> <span class="n">padding_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># y is allways the footpoint of the cardinality blocks</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">for</span> <span class="n">cardinal</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">):</span>
            <span class="c1"># after the first iteration c is the previous cardinality block output</span>
            <span class="c1"># its used to iterativly add the result, rather than summing all at once.</span>
            <span class="c1"># performance reasons, since otherwise multiple arrays must be stored at once!</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="n">cardinal</span><span class="p">][</span><span class="mi">0</span><span class="p">](</span><span class="n">y</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="n">cardinal</span><span class="p">][</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="n">block</span><span class="p">][</span><span class="n">cardinal</span><span class="p">][</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cardinal</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">()([</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">()([</span><span class="n">x</span><span class="p">,</span> <span class="n">residual</span><span class="p">])</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ResidualBlock.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.ResidualBlock.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ResidualBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;number_of_blocks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;residual_cardinality&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span><span class="p">,</span>
            <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScalarGatedSelfAttention</span>


<a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ScalarGatedSelfAttention</span><span class="p">(</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">intermediate_channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Scaled dot-product self attention that is gated by a learnable scalar.</p>

<details class="info" open>
  <summary>Info</summary>
  <p>Implementation as used in the <a href="https://arxiv.org/abs/2207.09204">VoloGAN paper</a>.</p>
</details>
<details class="architecture" open>
  <summary>Architecture</summary>
  <pre class="mermaid"><code>flowchart LR
    i([input_tensor])--&gt;f &amp; g &amp; h
    subgraph ScalarGatedSelfAttention
        f[ds.layers.DenseBlock] --&gt; t[Transpose]
        g[ds.layers.DenseBlock] &amp; t --&gt; m1[Multiply] --&gt; s[SoftMax]
        h[ds.layers.DenseBlock] &amp; s --&gt; m2[Multiply] --&gt; v[DenseBlock] --&gt; sc[ds.layers.ScaleLayer]
    end
    sc --&gt;o([output_tensor])</code></pre>
</details>  
      <p>Initializes the <code>ScalarGatedSelfAttention</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, applies spectral normalization to convolutional and dense layers.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>intermediate_channel</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Intermediate channels for the self attention mechanism.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the kernel weights.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">intermediate_channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `ScalarGatedSelfAttention` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        use_spec_norm (bool, optional): If true, applies spectral normalization to convolutional and dense layers.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        intermediate_channel (Optional[bool], optional): Intermediate channels for the self attention mechanism.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the kernel weights.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScalarGatedSelfAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span> <span class="o">=</span> <span class="n">intermediate_channel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScalarGatedSelfAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="n">num_channel</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span> <span class="o">=</span> <span class="n">num_channel</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">w_f</span> <span class="o">=</span> <span class="n">DenseBlock</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">apply_final_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w_g</span> <span class="o">=</span> <span class="n">DenseBlock</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">apply_final_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w_h</span> <span class="o">=</span> <span class="n">DenseBlock</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">apply_final_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w_fgh</span> <span class="o">=</span> <span class="n">DenseBlock</span><span class="p">(</span>
        <span class="n">units</span><span class="o">=</span><span class="n">num_channel</span><span class="p">,</span>
        <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
        <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">activation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">apply_final_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">LN_f</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LayerNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">LN_g</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LayerNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">LN_h</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LayerNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">LN_fgh</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LayerNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">ScaleLayer</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ScalarGatedSelfAttention</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (batch, height, width, channel)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor with same shape as input.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ScalarGatedSelfAttention` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (batch, height, width, channel)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor with same shape as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_f</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LN_f</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Permute</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_g</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LN_g</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_h</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LN_h</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

    <span class="n">f_g</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Multiply</span><span class="p">()([</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">])</span>
    <span class="n">f_g</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">f_g</span><span class="p">)</span>

    <span class="n">f_g_h</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Multiply</span><span class="p">()([</span><span class="n">f_g</span><span class="p">,</span> <span class="n">h</span><span class="p">])</span>
    <span class="n">f_g_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_fgh</span><span class="p">(</span><span class="n">f_g_h</span><span class="p">)</span>
    <span class="n">f_g_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LN_fgh</span><span class="p">(</span><span class="n">f_g_h</span><span class="p">)</span>
    <span class="n">f_g_h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">f_g_h</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Add</span><span class="p">()([</span><span class="n">f_g_h</span><span class="p">,</span> <span class="n">inputs</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalarGatedSelfAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;intermediate_channel&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">intermediate_channel</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ScaleLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaleLayer</span>


<a href="#DeepSaki.layers.layer_composites.ScaleLayer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ScaleLayer</span><span class="p">(</span>
    <span class="n">initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Trainable non-negative scalar that might be used as a trainable gate.</p>
<p>It is a single learnable weight that is multiplied by all weights of the input tensor through broadcasting.</p>
  
      <p>Initializes the <code>ScaleLayer</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer used to initialize the scalar weight.
Defaults to None..</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `ScaleLayer` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        initializer (tf.keras.initializers.Initializer, optional): Initializer used to initialize the scalar weight.</span>
<span class="sd">            Defaults to None..</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaleLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Ones</span><span class="p">()</span> <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initializer</span><span class="o">=</span><span class="n">initializer</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">NonNegative</span><span class="p">(),</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">min_ndim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ScaleLayer.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.ScaleLayer.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>ScaleLayer</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (batch, ...).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Non-negative scaled version of the input. Tensor of shape (batch, ...).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `ScaleLayer` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (batch, ...).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Non-negative scaled version of the input. Tensor of shape (batch, ...).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">inputs</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.ScaleLayer.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.ScaleLayer.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScaleLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="s2">&quot;initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">initializer</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.UpSampleBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">UpSampleBlock</span>


<a href="#DeepSaki.layers.layer_composites.UpSampleBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">UpSampleBlock</span><span class="p">(</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="n">UpSampleType</span> <span class="o">=</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">RESAMPLE_AND_CONV</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial up-sampling for grid-like data using <code>DeepSaki.layers.ConvBlock2D()</code>.</p>
  
      <p>Initializes the <code>UpSampleBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>upsampling</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.UpSampleType" href="../types/#DeepSaki.types.layers_enums.UpSampleType">UpSampleType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><em>description</em>. Defaults to UpSampleType.RESAMPLE_AND_CONV.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.UpSampleType" href="../types/#DeepSaki.types.layers_enums.UpSampleType">UpSampleType</a>.<span title="DeepSaki.types.layers_enums.UpSampleType.RESAMPLE_AND_CONV">RESAMPLE_AND_CONV</span></code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>String literal or tensorflow activation function object to obtain activation
function. Defaults to "leaky_relu".</p>
            </div>
          </td>
          <td>
                <code>&#39;leaky_relu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the convolutions kernels. Defaults to 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>use_spec_norm</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Applies spectral normalization to convolutional and dense layers. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether convolutions and dense layers include a bias or not. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>padding</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Padding type. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.types.layers_enums.PaddingType" href="../types/#DeepSaki.types.layers_enums.PaddingType">PaddingType</a>.<span title="DeepSaki.types.layers_enums.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the convolutions kernels.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gamma_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initialization of the normalization layers.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="n">UpSampleType</span> <span class="o">=</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">RESAMPLE_AND_CONV</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the `UpSampleBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        upsampling (UpSampleType, optional): _description_. Defaults to UpSampleType.RESAMPLE_AND_CONV.</span>
<span class="sd">        activation (str, optional): String literal or tensorflow activation function object to obtain activation</span>
<span class="sd">            function. Defaults to &quot;leaky_relu&quot;.</span>
<span class="sd">        kernels (int, optional): Size of the convolutions kernels. Defaults to 3.</span>
<span class="sd">        use_spec_norm (bool, optional): Applies spectral normalization to convolutional and dense layers. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        use_bias (bool, optional): Whether convolutions and dense layers include a bias or not. Defaults to True.</span>
<span class="sd">        padding (PaddingType, optional): Padding type. Defaults to PaddingType.ZERO.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initialization of the convolutions kernels.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        gamma_initializer (tf.keras.initializers.Initializer, optional): Initialization of the normalization layers.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">UpSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">=</span> <span class="n">upsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.UpSampleBlock.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.layer_composites.UpSampleBlock.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if <code>upsampling</code> is not supported.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if `upsampling` is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">UpSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">==</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">RESAMPLE_AND_CONV</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">UpSampling2D</span><span class="p">(</span><span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Conv2DBlock</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">number_of_blocks</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                <span class="n">use_spec_norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                <span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">==</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">TRANSPOSE_CONV</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2DTranspose</span><span class="p">(</span>
                <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">),</span>
                <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InstanceNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">))</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">==</span> <span class="n">UpSampleType</span><span class="o">.</span><span class="n">DEPTH_TO_SPACE</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">=</span><span class="mi">4</span> <span class="o">*</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
                <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
                <span class="n">kernel_initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_depth_to_space_block_size_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Undefined upsampling provided&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.UpSampleBlock.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.layer_composites.UpSampleBlock.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>UpSampleBlock</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h,w,c)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (b,h<em>2,w</em>2,c)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `UpSampleBlock` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (b,h,w,c)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (b,h*2,w*2,c)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">inputs</span>
    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.layer_composites.UpSampleBlock.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.layer_composites.UpSampleBlock.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">UpSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation</span><span class="p">,</span>
            <span class="s2">&quot;use_spec_norm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span><span class="p">,</span>
            <span class="s2">&quot;upsampling&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by <a href="https://github.com/sascha-kirch/DeepSaki/issues/new/?title=[Feedback]+layers+-+/reference/DeepSaki/layers/&labels=documentation" target="_blank" rel="noopener">telling us what you are missing</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../initializers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: initializers">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                initializers
              </div>
            </div>
          </a>
        
        
          
          <a href="../losses/" class="md-footer__link md-footer__link--next" aria-label="Next: losses">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                losses
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://sascha-kirch.github.io/" target="_blank" rel="noopener" title="sascha-kirch.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 8C119.252 8 8 119.252 8 256s111.252 248 248 248 248-111.252 248-248S392.748 8 256 8zm163.97 114.366c29.503 36.046 47.369 81.957 47.835 131.955-6.984-1.477-77.018-15.682-147.502-6.818-5.752-14.041-11.181-26.393-18.617-41.614 78.321-31.977 113.818-77.482 118.284-83.523zM396.421 97.87c-3.81 5.427-35.697 48.286-111.021 76.519-34.712-63.776-73.185-116.168-79.04-124.008 67.176-16.193 137.966 1.27 190.061 47.489zm-230.48-33.25c5.585 7.659 43.438 60.116 78.537 122.509-99.087 26.313-186.36 25.934-195.834 25.809C62.38 147.205 106.678 92.573 165.941 64.62zM44.17 256.323c0-2.166.043-4.322.108-6.473 9.268.19 111.92 1.513 217.706-30.146 6.064 11.868 11.857 23.915 17.174 35.949-76.599 21.575-146.194 83.527-180.531 142.306C64.794 360.405 44.17 310.73 44.17 256.323zm81.807 167.113c22.127-45.233 82.178-103.622 167.579-132.756 29.74 77.283 42.039 142.053 45.189 160.638-68.112 29.013-150.015 21.053-212.768-27.882zm248.38 8.489c-2.171-12.886-13.446-74.897-41.152-151.033 66.38-10.626 124.7 6.768 131.947 9.055-9.442 58.941-43.273 109.844-90.795 141.978z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/sascha-kirch/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/sascha-kirch" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@SaschaKirch" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>