
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Custom deep learning code for TensorFlow.">
      
      
      
      
        <link rel="prev" href="../initializers/">
      
      
        <link rel="next" href="../loss/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>layers - DeepSaki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="grey">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#DeepSaki.layers.layer_composites.Conv2DBlock" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="DeepSaki" class="md-header__button md-logo" aria-label="DeepSaki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DeepSaki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              layers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sascha-kirch/DeepSaki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sascha-kirch/DeepSaki
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Start

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="DeepSaki" class="md-nav__button md-logo" aria-label="DeepSaki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DeepSaki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sascha-kirch/DeepSaki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    sascha-kirch/DeepSaki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    DeepSaki
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            DeepSaki
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../activations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    activations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../augmentations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    augmentations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    initializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    layers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    layers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.Conv2DBlock" class="md-nav__link">
    Conv2DBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.Conv2DSplitted" class="md-nav__link">
    Conv2DSplitted
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.DenseBlock" class="md-nav__link">
    DenseBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.DownSampleBlock" class="md-nav__link">
    DownSampleBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResBlockDown" class="md-nav__link">
    ResBlockDown
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResBlockUp" class="md-nav__link">
    ResBlockUp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ResidualIdentityBlock" class="md-nav__link">
    ResidualIdentityBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="md-nav__link">
    ScalarGatedSelfAttention
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.ScaleLayer" class="md-nav__link">
    ScaleLayer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_composites.UpSampleBlock" class="md-nav__link">
    UpSampleBlock
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.padding.ReflectionPadding2D" class="md-nav__link">
    ReflectionPadding2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FFT2D" class="md-nav__link">
    FFT2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FFT3D" class="md-nav__link">
    FFT3D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D" class="md-nav__link">
    FourierConvolution2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.FourierFilter2D" class="md-nav__link">
    FourierFilter2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.MultiplicationType" class="md-nav__link">
    MultiplicationType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.fourier_layer.iFFT2D" class="md-nav__link">
    iFFT2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.FourierPooling2D" class="md-nav__link">
    FourierPooling2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.FrequencyFilter" class="md-nav__link">
    FrequencyFilter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.GlobalSumPooling2D" class="md-nav__link">
    GlobalSumPooling2D
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.LearnedPooling" class="md-nav__link">
    LearnedPooling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.pooling.rFFT2DFilter" class="md-nav__link">
    rFFT2DFilter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.InitializerFunc" class="md-nav__link">
    InitializerFunc
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.PaddingType" class="md-nav__link">
    PaddingType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.dropout_func" class="md-nav__link">
    dropout_func()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.get_initializer" class="md-nav__link">
    get_initializer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.pad_func" class="md-nav__link">
    pad_func()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.layer_helper.plot_layer" class="md-nav__link">
    plot_layer()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Bottleneck" class="md-nav__link">
    Bottleneck
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Decoder" class="md-nav__link">
    Decoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DeepSaki.layers.sub_model_composites.Encoder" class="md-nav__link">
    Encoder
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../loss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    loss
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../optimizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optimizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>layers</h1>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.Conv2DBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Conv2DBlock</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Conv2DBlock</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Wraps a two-dimensional convolution into a more complex building block
args:
  - filters: number of filters in the output feature map
  - kernels: size of the convolutions kernels
  - use_residual_Conv2DBlock (optional, default: False):
  - split_kernels (optional, default: False): to decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly
  - number_of_convs (optional, default: 1): number of consecutive convolutional building blocks, i.e. Conv2DBlock.
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout
  - final_activation (optional, default: True): whether or not to activate the output of this layer
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - strides (optional, default: (1,1)): stride of the filter
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - apply_final_normalization (optional, default: True): Whether or not to place a normalization on the layer's output
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_residual_Conv2DBlock</span> <span class="o">=</span> <span class="n">use_residual_Conv2DBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_convs</span> <span class="o">=</span> <span class="n">number_of_convs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span> <span class="o">=</span> <span class="n">final_activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span> <span class="o">=</span> <span class="n">apply_final_normalization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">kernels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># assumes odd kernel size, which is typical!</span>

    <span class="k">if</span> <span class="n">split_kernels</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Conv2DSplitted</span><span class="p">(</span>
                <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span> <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_convs</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_spec_norm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span>
                    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
                        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
                        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="n">kernels</span><span class="p">,</span> <span class="n">kernels</span><span class="p">),</span>
                        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
                        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_convs</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
                    <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
                    <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="n">kernels</span><span class="p">,</span> <span class="n">kernels</span><span class="p">),</span>
                    <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
                    <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                    <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_convs</span><span class="p">)</span>
            <span class="p">]</span>

    <span class="k">if</span> <span class="n">apply_final_normalization</span><span class="p">:</span>
        <span class="n">num_instancenorm_blocks</span> <span class="o">=</span> <span class="n">number_of_convs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_instancenorm_blocks</span> <span class="o">=</span> <span class="n">number_of_convs</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IN_blocks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InstanceNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_instancenorm_blocks</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.Conv2DSplitted" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Conv2DSplitted</span>


<a href="#DeepSaki.layers.layer_composites.Conv2DSplitted" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Conv2DSplitted</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>To decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly
args:
  - filters: number of filters in the output feature map
  - kernels: size of the convolutions kernels, which will be translated to (kernels, 1) &amp; (1,kernels) for the first and seccond convolution respectivly
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional  layers
  - strides (optional, default: (1,1)): stride of the filter
  - use_bias (optional, default: True): determines whether convolutions layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strides</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Conv2DSplitted</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernels</span><span class="p">),</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="n">kernels</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">use_spec_norm</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.DenseBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DenseBlock</span>


<a href="#DeepSaki.layers.layer_composites.DenseBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DenseBlock</span><span class="p">(</span>
    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">numberOfLayers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Wraps a dense layer into a more complex building block
args:
  - units: number of units of each dense block
  - numberOfLayers (optional, default: 1): number of consecutive convolutional building blocks, i.e. Conv2DBlock.
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout
  - final_activation (optional, default: True): whether or not to activate the output of this layer
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - apply_final_normalization (optional, default: True): Whether or not to place a normalization on the layer's output
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">units</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">numberOfLayers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">final_activation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_final_normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DenseBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">numberOfLayers</span> <span class="o">=</span> <span class="n">numberOfLayers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">final_activation</span> <span class="o">=</span> <span class="n">final_activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_final_normalization</span> <span class="o">=</span> <span class="n">apply_final_normalization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>

    <span class="k">if</span> <span class="n">use_spec_norm</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DenseBlocks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpectralNormalization</span><span class="p">(</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfLayers</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DenseBlocks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfLayers</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="n">apply_final_normalization</span><span class="p">:</span>
        <span class="n">num_instancenorm_blocks</span> <span class="o">=</span> <span class="n">numberOfLayers</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_instancenorm_blocks</span> <span class="o">=</span> <span class="n">numberOfLayers</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IN_blocks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InstanceNormalization</span><span class="p">(</span><span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_instancenorm_blocks</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.DownSampleBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">DownSampleBlock</span>


<a href="#DeepSaki.layers.layer_composites.DownSampleBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">DownSampleBlock</span><span class="p">(</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;average_pooling&quot;</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial down-sampling for grid-like data
args:
  - downsampling (optional, default: "average_pooling"):
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - kernels (optional, default: 3): size of the convolution's kernels when using downsampling = "conv_stride_2"
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;average_pooling&quot;</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DownSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">=</span> <span class="n">downsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResBlockDown" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResBlockDown</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockDown" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResBlockDown</span><span class="p">(</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial down-sampling with residual connection for grid-like data
args:
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockDown</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResBlockUp" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResBlockUp</span>


<a href="#DeepSaki.layers.layer_composites.ResBlockUp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResBlockUp</span><span class="p">(</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial down-sampling with residual connection for grid-like data
args:
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResBlockUp</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ResidualIdentityBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ResidualIdentityBlock</span>


<a href="#DeepSaki.layers.layer_composites.ResidualIdentityBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ResidualIdentityBlock</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">numberOfBlocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Residual identity block with configurable cardinality
args:
  - filters: number of filters in the output feature map
  - kernels: size of the convolutions kernels
  - numberOfBlocks (optional, default: 1): number of consecutive convolutional building blocks.
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - residual_cardinality (optional, default: 1): number of parallel convolution blocks
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">numberOfBlocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ResidualIdentityBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">numberOfBlocks</span> <span class="o">=</span> <span class="n">numberOfBlocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">kernels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># assumes odd kernel size, which is typical!</span>

    <span class="k">if</span> <span class="n">residual_cardinality</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">filters</span> <span class="o">/</span> <span class="mi">32</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">16</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">filters</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="n">filters</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># for each block, add several con</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfBlocks</span><span class="p">):</span>
        <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">residual_cardinality</span><span class="p">):</span>
            <span class="n">cardinals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">Conv2DBlock</span><span class="p">(</span>
                        <span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span><span class="p">,</span>
                        <span class="n">use_residual_Conv2DBlock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">number_of_convs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                        <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
                        <span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">Conv2DBlock</span><span class="p">(</span>
                        <span class="n">filters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intermediateFilters</span><span class="p">,</span>
                        <span class="n">use_residual_Conv2DBlock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">kernels</span><span class="o">=</span><span class="n">kernels</span><span class="p">,</span>
                        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">number_of_convs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                        <span class="n">padding</span><span class="o">=</span><span class="n">PaddingType</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
                        <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
                        <span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">Conv2DBlock</span><span class="p">(</span>
                        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
                        <span class="n">use_residual_Conv2DBlock</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">kernels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">split_kernels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">number_of_convs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">,</span>
                        <span class="n">use_spec_norm</span><span class="o">=</span><span class="n">use_spec_norm</span><span class="p">,</span>
                        <span class="n">use_bias</span><span class="o">=</span><span class="n">use_bias</span><span class="p">,</span>
                        <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                        <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">kernel_initializer</span><span class="p">,</span>
                        <span class="n">gamma_initializer</span><span class="o">=</span><span class="n">gamma_initializer</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cardinals</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScalarGatedSelfAttention</span>


<a href="#DeepSaki.layers.layer_composites.ScalarGatedSelfAttention" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ScalarGatedSelfAttention</span><span class="p">(</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">intermediate_channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Scaled dot-product self attention that is gated by a learnable scalar.
args:
- use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
- intermediateChannel (optional, default: None): Integer that determines the intermediate channels within the self-attention model. If None, intermediate channels = inputChannels/8
- kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
- gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">intermediate_channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScalarGatedSelfAttention</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intermediateChannel</span> <span class="o">=</span> <span class="n">intermediate_channel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.ScaleLayer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ScaleLayer</span>


<a href="#DeepSaki.layers.layer_composites.ScaleLayer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ScaleLayer</span><span class="p">(</span>
    <span class="n">initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Ones</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>trainable scalar that can act as trainable gate
args:
  - initializer (optional, default: tf.keras.initializers.Ones()): initializes the scalar weight</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Ones</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ScaleLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initializer</span> <span class="o">=</span> <span class="n">initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initializer</span><span class="o">=</span><span class="n">initializer</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">NonNegative</span><span class="p">(),</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_composites.UpSampleBlock" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">UpSampleBlock</span>


<a href="#DeepSaki.layers.layer_composites.UpSampleBlock" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">UpSampleBlock</span><span class="p">(</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2D_upsample_and_conv&quot;</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Spatial up-sampling for grid-like data
args:
  - upsampling (optional, default: "2D_upsample_and_conv"):
  - activation (optional, default: "leaky_relu"): string literal to obtain activation function
  - kernels (optional, default: 3): size of the convolution's kernels when using upsampling = "2D_upsample_and_conv" or "transpose_conv"
  - split_kernels (optional, default: False): to decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly. applies to upsampling = "2D_upsample_and_conv"
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - padding (optional, default: "zero"): padding type. Options are "none", "zero" or "reflection"
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/layer_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2D_upsample_and_conv&quot;</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">UpSampleBlock</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">=</span> <span class="n">upsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>Collection of padding layer operations.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.padding.ReflectionPadding2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ReflectionPadding2D</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">ReflectionPadding2D</span><span class="p">(</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>


                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ReflectionPadding2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.padding.ReflectionPadding2D.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D.compute_output_shape" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">compute_output_shape</span><span class="p">(</span>
    <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>If you are using "channels_last" configuration</p>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_output_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If you are using &quot;channels_last&quot; configuration&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">input_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">input_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.padding.ReflectionPadding2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.padding.ReflectionPadding2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/padding.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ReflectionPadding2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FFT2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FFT2D</span>


<a href="#DeepSaki.layers.fourier_layer.FFT2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FFT2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Calculates the 2D descrete fourier transform over the 2 innermost channels (height, width) over a 4 channel input (batch, height, width, channel)
args:
- is_channel_first: True or False. If True, input shape is assumed to be [batch,channel,height,width]. If False, input shape is assumed to be [batch,height,width,channel]
- applyRealFFT: True or False. If True, rfft2D is applied, which assumes real valued inputs and halves the width of the output. If False, fft2D is applied, which assumes complex input.
- shiftFFT: True or False. If true, low frequency componentes are centered.
- **kwargs: keyword arguments passed to the parent class tf.keras.layers.Layer.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span> <span class="o">=</span> <span class="n">applyRealFFT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span> <span class="o">=</span> <span class="n">shiftFFT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">mixed_precision</span><span class="o">.</span><span class="n">global_policy</span><span class="p">()</span><span class="o">.</span><span class="n">compute_dtype</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FFT2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;applyRealFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span><span class="p">,</span>
            <span class="s2">&quot;shiftFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span><span class="p">,</span>
            <span class="s2">&quot;policy_compute_dtype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FFT3D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FFT3D</span>


<a href="#DeepSaki.layers.fourier_layer.FFT3D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FFT3D</span><span class="p">(</span>
    <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Calculates the 3D descrete fourier transform over the 3 innermost channels (height, width, channel) over a 4 channel input (batch, height, width, channel)
args:
- applyRealFFT: True or False. If True, rfft3D is applied, which assumes real valued inputs and halves the width of the output. If False, fft3D is applied, which assumes complex input.
- shiftFFT: True or False. If true, low frequency componentes are centered.
- **kwargs: keyword arguments passed to the parent class tf.keras.layers.Layer.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span> <span class="o">=</span> <span class="n">applyRealFFT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span> <span class="o">=</span> <span class="n">shiftFFT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">mixed_precision</span><span class="o">.</span><span class="n">global_policy</span><span class="p">()</span><span class="o">.</span><span class="n">compute_dtype</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FFT3D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FFT3D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FFT3D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;applyRealFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span><span class="p">,</span>
            <span class="s2">&quot;shiftFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span><span class="p">,</span>
            <span class="s2">&quot;policy_compute_dtype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy_compute_dtype</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierConvolution2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierConvolution2D</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierConvolution2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span>
        <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span>
    <span class="p">),</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">(),</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_conjugate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pad_to_power_2</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Performs a convolution by transforming into fourier domain. Layer input is asumed to be in spatial domain.</p>
  
      <p>Initialize the <code>FourierConvolution2D</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of individual filters.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>kernels</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[int, int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Kernel of the spatial convolution. Expected input
<code>[height,width]</code>. If <code>None</code>, kernel size is set to the input height and width. Defaults to <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to us bias weights. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kernel_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the kernels of
the convolution layer. Defaults to <code>tf.keras.initializers.RandomUniform(-0.05, 0.05)</code>.</p>
            </div>
          </td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.RandomUniform">RandomUniform</span>(-0.05, 0.05)</code>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the bias weights
of the convolution layer. Defaults to <code>tf.keras.initializers.Zeros()</code>.</p>
            </div>
          </td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Zeros">Zeros</span>()</code>
          </td>
        </tr>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>apply_conjugate</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, the kernels are conjugated. If so, a multiplication in the
frequency domain corresponds to a cross correlation in the spatial domain, which is actually what a
convolution layer is doing. Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>pad_to_power_2</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, input tensor is padded. FFT algorithm runs faster for lengths of
power of two. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.MultiplicationType" href="#DeepSaki.layers.fourier_layer.MultiplicationType">MultiplicationType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of multiplication of the input and the weights:
[<code>MultiplicationType.ELEMENT_WISE</code> | <code>MultiplicationType.MATRIX_PRODUCT</code>]. Defaults to
<code>MultiplicationType.ELEMENT_WISE</code>.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.fourier_layer.MultiplicationType" href="#DeepSaki.layers.fourier_layer.MultiplicationType">MultiplicationType</a>.<span title="DeepSaki.layers.fourier_layer.MultiplicationType.ELEMENT_WISE">ELEMENT_WISE</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">(),</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">apply_conjugate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pad_to_power_2</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">MultiplicationType</span> <span class="o">=</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `FourierConvolution2D` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int): Number of individual filters.</span>
<span class="sd">        kernels (Optional[Tuple[int, int]], optional): Kernel of the spatial convolution. Expected input</span>
<span class="sd">            `[height,width]`. If `None`, kernel size is set to the input height and width. Defaults to `None`.</span>
<span class="sd">        use_bias (bool, optional): Whether or not to us bias weights. Defaults to `True`.</span>
<span class="sd">        kernel_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the kernels of</span>
<span class="sd">            the convolution layer. Defaults to `tf.keras.initializers.RandomUniform(-0.05, 0.05)`.</span>
<span class="sd">        bias_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the bias weights</span>
<span class="sd">            of the convolution layer. Defaults to `tf.keras.initializers.Zeros()`.</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        apply_conjugate (bool, optional): If true, the kernels are conjugated. If so, a multiplication in the</span>
<span class="sd">            frequency domain corresponds to a cross correlation in the spatial domain, which is actually what a</span>
<span class="sd">            convolution layer is doing. Defaults to `False`.</span>
<span class="sd">        pad_to_power_2 (bool, optional): If true, input tensor is padded. FFT algorithm runs faster for lengths of</span>
<span class="sd">            power of two. Defaults to `True`.</span>
<span class="sd">        method (MultiplicationType, optional): Type of multiplication of the input and the weights:</span>
<span class="sd">            [`MultiplicationType.ELEMENT_WISE` | `MultiplicationType.MATRIX_PRODUCT`]. Defaults to</span>
<span class="sd">            `MultiplicationType.ELEMENT_WISE`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span> <span class="o">=</span> <span class="n">bias_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span> <span class="o">=</span> <span class="n">apply_conjugate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span> <span class="o">=</span> <span class="n">pad_to_power_2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">MATRIX_PRODUCT</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix_product</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="n">MultiplicationType</span><span class="o">.</span><span class="n">ELEMENT_WISE</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elementwise_product</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Entered method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> unkown. Use &quot;MATRIX_PRODUCT&quot; or &quot;ELEMENT_WISE&quot;.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">)</span>

    <span class="c1"># weights are independent from batch size [out_filter,inp_filter,kernel,kernel]. I leave the two kernels last, since I then can easily calculate the 2d FFT at once!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;kernel&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_image_padding</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_filter</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bias&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span> <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FourierConvolution2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of data in spatial domain of shape <code>(b,h,w,c)</code> or <code>(b,c,h,w)</code> depending on
<code>is_channel_first</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If Layer has not been built.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor in spatial domain of same shape as input.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `FourierConvolution2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of data in spatial domain of shape `(b,h,w,c)` or `(b,c,h,w)` depending on</span>
<span class="sd">            `is_channel_first`</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If Layer has not been built.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor in spatial domain of same shape as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">built</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This model has not yet been built.&quot;</span><span class="p">)</span>

    <span class="c1"># FFT2D is calculated over last two dimensions!</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bhwc-&gt;bchw&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

    <span class="c1"># Optionally pad to power of 2, to speed up FFT</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span><span class="p">:</span>
        <span class="n">image_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_image_shape_power_2</span><span class="p">()</span>

    <span class="c1"># Compute DFFTs for both inputs and kernel weights</span>
    <span class="n">inputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="p">)</span>  <span class="c1"># [batch,height,width,channel]</span>
    <span class="n">kernels_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span><span class="p">:</span>
        <span class="n">kernels_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">kernels_f_domain</span><span class="p">)</span>  <span class="c1"># to be equvivalent to the cross correlation</span>

    <span class="n">outputs_f_domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">inputs_f_domain</span><span class="p">,</span> <span class="n">kernels_f_domain</span><span class="p">)</span>

    <span class="c1"># Inverse rDFFT</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">irfft2d</span><span class="p">(</span><span class="n">outputs_f_domain</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">paddedImageShape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># shift the samples to obtain linear conv from circular conv</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span>
        <span class="n">output</span><span class="p">,</span>
        <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp_width</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Optionally add bias</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>

    <span class="c1"># reverse the channel configuration to its initial config</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bchw-&gt;bhwc&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierConvolution2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FourierConvolution2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierConvolution2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;kernels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">,</span>
            <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
            <span class="s2">&quot;apply_conjugate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_conjugate</span><span class="p">,</span>
            <span class="s2">&quot;pad_to_power_2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_to_power_2</span><span class="p">,</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.FourierFilter2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierFilter2D</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierFilter2D</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span>
        <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span>
    <span class="p">),</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">(),</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Complex-valued learnable filter in frequency domain. Expects input data to be in the fourier domain.</p>
<p>To transform an image into the frequency domain you can use <code>DeepSaki.layers.FFT2D</code>.</p>
<p><strong>Example:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">DeepSaki</span> <span class="k">as</span> <span class="nn">dsk</span>
<span class="c1"># pseudo code to load data</span>
<span class="n">image_dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">dsk</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FFT2D</span><span class="p">()(</span><span class="n">image_dataset</span><span class="p">)</span>
<span class="hll"><span class="n">x</span> <span class="o">=</span> <span class="n">dsk</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">FourierFilter2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span><span class="n">x</span> <span class="o">=</span> <span class="n">dsk</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">iFFT2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
  
      <p>Initialize the <code>FourierFilter2D</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filters</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of independent filters</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>use_bias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether or not to us bias weights. Defaults to <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>filter_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the wheights of
the filter layer. Defaults to <code>tf.keras.initializers.RandomUniform(-0.05, 0.05)</code>.</p>
            </div>
          </td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.RandomUniform">RandomUniform</span>(-0.05, 0.05)</code>
          </td>
        </tr>
        <tr>
          <td><code>bias_initializer</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initializer to initialize the wheights of
the bias weights. Defaults to <code>tf.keras.initializers.Zeros()</code>.</p>
            </div>
          </td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Zeros">Zeros</span>()</code>
          </td>
        </tr>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Set true if input shape is (b,c,h,w) and false if input shape is
(b,h,w,c). Defaults to <code>False</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
    <span class="n">bias_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Zeros</span><span class="p">(),</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `FourierFilter2D` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        filters (int): Number of independent filters</span>
<span class="sd">        use_bias (bool, optional): Whether or not to us bias weights. Defaults to `True`.</span>
<span class="sd">        filter_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the wheights of</span>
<span class="sd">            the filter layer. Defaults to `tf.keras.initializers.RandomUniform(-0.05, 0.05)`.</span>
<span class="sd">        bias_initializer (tf.keras.initializers.Initializer, optional): Initializer to initialize the wheights of</span>
<span class="sd">            the bias weights. Defaults to `tf.keras.initializers.Zeros()`.</span>
<span class="sd">        is_channel_first (bool, optional): Set true if input shape is (b,c,h,w) and false if input shape is</span>
<span class="sd">            (b,h,w,c). Defaults to `False`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span> <span class="o">=</span> <span class="n">make_initializer_complex</span><span class="p">(</span><span class="n">filter_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span> <span class="o">=</span> <span class="n">make_initializer_complex</span><span class="p">(</span><span class="n">bias_initializer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fourier_filter</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># shape: batch, height, width, input_filters, output_filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fourier_bias</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_shape</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">batch_size</span><span class="p">,</span> <span class="n">inp_filter</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">batch_size</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span><span class="p">,</span> <span class="n">inp_filter</span> <span class="o">=</span> <span class="n">input_shape</span>

    <span class="c1"># weights are independent from batch size. Filter dimensions differ from convolution, since FFT2D is calculated over last 2 dimensions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fourier_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="n">inp_filter</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">],</span>
        <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span><span class="p">,</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span>
    <span class="p">):</span>  <span class="c1"># shape: [filter,1,1] so it can be broadcasted when adding to the output, since FFT asumes channel first!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fourier_bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bias&quot;</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">initializer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Output shape: batch_size, self.filters, inp_height, inp_width. Filters is zero, since concatenated later</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>I take advantage of broadcasting to calculate the batches: https://numpy.org/doc/stable/user/basics.broadcasting.html</p>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;I take advantage of broadcasting to calculate the batches: https://numpy.org/doc/stable/user/basics.broadcasting.html&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">built</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This model has not yet been built.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># FFT2D is calculated over last two dimensions!</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bhwc-&gt;bchw&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">output</span><span class="p">,</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span>
                    <span class="n">inputs</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier_filter</span><span class="p">[</span>
                        <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="nb">filter</span>
                    <span class="p">],</span>  <span class="c1"># inputs:(batch, inp_filter, height, width ), fourier_filter:(...,inp_filter,height, width, out_filter)</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># sum over all applied filters</span>
                    <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">axis</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># is the new filter count, since channel first</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fourier_bias</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># reverse the channel configuration to its initial config</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bchw-&gt;bhwc&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.FourierFilter2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.FourierFilter2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierFilter2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filters</span><span class="p">,</span>
            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span><span class="p">,</span>
            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_initializer</span><span class="p">,</span>
            <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">,</span>
            <span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.MultiplicationType" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MultiplicationType</span>


<a href="#DeepSaki.layers.fourier_layer.MultiplicationType" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p><code>Enum</code> used to define how two matrices shall be multiplied.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ELEMENT_WISE</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates to apply an element-wise multiplication of 2 tensors.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>MATRIX_PRODUCT</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates to apply a matrix-product between 2 tensors.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.fourier_layer.iFFT2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">iFFT2D</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">iFFT2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Calculates the 2D inverse FFT and reverses the center shift operation
args:
- is_channel_first: True or False. If True, input shape is assumed to be [batch,channel,height,width]. If False, input shape is assumed to be [batch,height,width,channel]
- applyRealFFT: True or False. If True, rfft2D is applied, which assumes real valued inputs and halves the width of the output. If False, fft2D is applied, which assumes complex input.
- shiftFFT: True or False. If True, shift operation of fourier transform is reversed before calculating the inverse fourier transformation
- **kwargs: keyword arguments passed to the parent class tf.keras.layers.Layer.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">applyRealFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shiftFFT</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">iFFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span> <span class="o">=</span> <span class="n">applyRealFFT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span> <span class="o">=</span> <span class="n">shiftFFT</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.fourier_layer.iFFT2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.fourier_layer.iFFT2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/fourier_layer.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">iFFT2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="s2">&quot;applyRealFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">applyRealFFT</span><span class="p">,</span> <span class="s2">&quot;shiftFFT&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shiftFFT</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>Collection of pooling layer operations to reduce the spatial dimensionality of a feature map.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.FourierPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FourierPooling2D</span>


<a href="#DeepSaki.layers.pooling.FourierPooling2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">FourierPooling2D</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Pooling in frequency domain by truncating high frequencies using a center crop operation.</p>
<p>Layer input is asumed to be in frequency domain and shifted, such that the center frequency is in the center of
the grid.</p>
<p>If this is the case, the center represents the frequency of 0Hz (hence an offset). The further away from the center
the higher the frequency component. Center cropping removes high frequency components, hence can be seen as a low
pass filter</p>
  
      <p>Initializes an instance of <code>FourierPooling2D</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, input shape is assumed to be (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).
If False, input shape is assumed to be (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>). Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes an instance of `FourierPooling2D`.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): If True, input shape is assumed to be (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">            If False, input shape is assumed to be (`batch`,`height`,`width`,`channel`). Defaults to False.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FourierPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.FourierPooling2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.FourierPooling2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>FourierPooling2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>). Tensor is asumed to be in frequency domain of type <code>tf.complex64</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pooled tensor of shape (<code>batch</code>,<code>channel</code>,<code>height/2</code>,<code>width/2</code>) or (<code>batch</code>,<code>height/2</code>,<code>width/2</code>,<code>channel</code>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `FourierPooling2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`). Tensor is asumed to be in frequency domain of type `tf.complex64`</span>
<span class="sd">        or `tf.complex128`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Pooled tensor of shape (`batch`,`channel`,`height/2`,`width/2`) or (`batch`,`height/2`,`width/2`,`channel`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bchw-&gt;bhwc&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">central_crop</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># assumes channel last</span>

    <span class="c1"># reverse to previous channel config!</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bhwc-&gt;bchw&quot;</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.FourierPooling2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.FourierPooling2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">FourierPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.FrequencyFilter" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">FrequencyFilter</span>


<a href="#DeepSaki.layers.pooling.FrequencyFilter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p><code>Enum</code> used to define valid filters for <code>rFFT2DFilter</code>.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>LOW_PASS</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates that low frequency components shall be kept and high frequency components shall be
filtered.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>HIGH_PASS</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates that high frequency components shall be kept and low frequency components shall be
filtered.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.GlobalSumPooling2D" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">GlobalSumPooling2D</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">GlobalSumPooling2D</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Global sum pooling operation for spatial data.</p>

<details class="tips" open>
  <summary>Tips</summary>
  <p>Similar to tensorflow's <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/GlobalMaxPooling2D">GlobalMaxPooling2D</a>
and <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/GlobalAveragePooling2D">GlobalAveragePooling2D</a></p>
</details>  
      <p>Initialize the <code>GlobalSumPooling2D</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `GlobalSumPooling2D` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">GlobalSumPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;channels_last&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">InputSpec</span><span class="p">(</span><span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>GlobalSumPooling2D</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>channel</code>) where the elements are summed to reduce the axis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `GlobalSumPooling2D` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape (`batch`,`channel`) where the elements are summed to reduce the axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">input_tensor</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.compute_output_shape" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_output_shape</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.compute_output_shape" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">compute_output_shape</span><span class="p">(</span>
    <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Computes the output shape of the layer.</p>
<p>This method will cause the layer's state to be built, if that has not happened before. This requires that the
layer will later be used with inputs that match the input shape provided here.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A TensorShape instance representing the shape of the layer's output Tensor.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_output_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the output shape of the layer.</span>

<span class="sd">    This method will cause the layer&#39;s state to be built, if that has not happened before. This requires that the</span>
<span class="sd">    layer will later be used with inputs that match the input shape provided here.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A TensorShape instance representing the shape of the layer&#39;s output Tensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_shape</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span> <span class="o">==</span> <span class="s2">&quot;channels_last&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.GlobalSumPooling2D.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.GlobalSumPooling2D.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">GlobalSumPooling2D</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_format</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.LearnedPooling" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">LearnedPooling</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">LearnedPooling</span><span class="p">(</span><span class="n">pool_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Layer that learns a pooling operation.</p>
<p>Instead of using <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/MaxPooling2D">MaxPooling2D</a> or
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/AveragePooling2D">AveragePooling2D</a> the layer learns a
pooling operation.</p>

<details class="info" open>
  <summary>Info</summary>
  <p>Under the hood this layer simply performs a non-overlapping convolution operation.</p>
</details>  
      <p>Initializes an instance of <code>LearnedPooling</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pool_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the pooling window and the stride of the convolution operation. If the
input is of shape (b, h, w, c), the output is (b,h/pool_size,w/pool_size,c). Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes an instance of `LearnedPooling`.</span>

<span class="sd">    Args:</span>
<span class="sd">        pool_size (int, optional): Size of the pooling window and the stride of the convolution operation. If the</span>
<span class="sd">            input is of shape (b, h, w, c), the output is (b,h/pool_size,w/pool_size,c). Defaults to 2.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">LearnedPooling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span> <span class="o">=</span> <span class="n">pool_size</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pooling</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">strides</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>LearnedPooling</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pooled tensor of shape (<code>batch</code>,<code>height/pool_size</code>,<code>width/pool_size</code>,<code>channel</code>)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `LearnedPooling` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Pooled tensor of shape (`batch`,`height/pool_size`,`width/pool_size`,`channel`)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pooling</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.LearnedPooling.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.LearnedPooling.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">LearnedPooling</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;pool_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool_size</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.pooling.rFFT2DFilter" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">rFFT2DFilter</span>


<a href="#DeepSaki.layers.pooling.rFFT2DFilter" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">rFFT2DFilter</span><span class="p">(</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filter_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">HIGH_PASS</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Low or high pass filtering by truncating higher or lower frequencies in the frequency domain.</p>
<p>Layer input is asumed to be in spatial domain. It is transformed into the frequency domain applying a 2D real FFT.
Then the center-crop operation is performed and depending of the shift, either low or high frequencies are removed.
Afterwards, the cropped region is zero padded and then the inverse real 2D FFT is calculated to transform back into
the spatial domain.</p>
  
      <p>Initialize the <code>rFFT2DFilter</code> object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>is_channel_first</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, input shape is assumed to be (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).
If False, input shape is assumed to be (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>). Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>filter_type</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[Frequency_Filter.<span title="Frequency_Filter.LOW_PASS">LOW_PASS</span>, Frequency_Filter.<span title="Frequency_Filter.HIGH_PASS">HIGH_PASS</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If
<code>Frequency_Filter.LOW_PASS</code>, high frequency values are truncated, if <code>Frequency_Filter.HIGH_PASS</code>, low
frequencies are truncated. Defaults to <code>Frequency_Filter.LOW_PASS</code>.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.pooling.FrequencyFilter" href="#DeepSaki.layers.pooling.FrequencyFilter">FrequencyFilter</a>.<span title="DeepSaki.layers.pooling.FrequencyFilter.LOW_PASS">LOW_PASS</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional key word arguments passed to the base class.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">is_channel_first</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filter_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">HIGH_PASS</span><span class="p">]</span> <span class="o">=</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the `rFFT2DFilter` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        is_channel_first (bool, optional): If True, input shape is assumed to be (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">            If False, input shape is assumed to be (`batch`,`height`,`width`,`channel`). Defaults to False.</span>
<span class="sd">        filter_type (Literal[Frequency_Filter.LOW_PASS,Frequency_Filter.HIGH_PASS], optional): If</span>
<span class="sd">            `Frequency_Filter.LOW_PASS`, high frequency values are truncated, if `Frequency_Filter.HIGH_PASS`, low</span>
<span class="sd">            frequencies are truncated. Defaults to `Frequency_Filter.LOW_PASS`.</span>
<span class="sd">        kwargs (Any): Additional key word arguments passed to the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span> <span class="o">=</span> <span class="n">is_channel_first</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_type</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.rFFT2DFilter.build" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">build</span>


<a href="#DeepSaki.layers.pooling.rFFT2DFilter.build" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Build layer depending on the <code>input_shape</code> (output shape of the previous layer).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_shape</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.TensorShape">TensorShape</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shape of the input tensor to this layer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build layer depending on the `input_shape` (output shape of the previous layer).</span>

<span class="sd">    Args:</span>
<span class="sd">        input_shape (tf.TensorShape): Shape of the input tensor to this layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">batch_size</span><span class="p">,</span> <span class="n">inp_filter</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">batch_size</span><span class="p">,</span> <span class="n">inp_height</span><span class="p">,</span> <span class="n">inp_width</span><span class="p">,</span> <span class="n">inp_filter</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">offset_height</span> <span class="o">=</span> <span class="n">inp_height</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">offset_width</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_height</span> <span class="o">=</span> <span class="n">inp_height</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">inp_width</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>  <span class="c1"># 1/4 because real spectrum has allready half width and filter only applies to positive frequencies in width</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.rFFT2DFilter.call" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">call</span>


<a href="#DeepSaki.layers.pooling.rFFT2DFilter.call" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Calls the <code>rFFT2DFilter</code> layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tensor of shape (<code>batch</code>,<code>height</code>,<code>width</code>,<code>channel</code>) or
(<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If Layer has not been built.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filtered tensor with shape (<code>batch</code>,<code>channel</code>,<code>height</code>,<code>width</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calls the `rFFT2DFilter` layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs (tf.Tensor): Tensor of shape (`batch`,`height`,`width`,`channel`) or</span>
<span class="sd">            (`batch`,`channel`,`height`,`width`).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If Layer has not been built.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Filtered tensor with shape (`batch`,`channel`,`height`,`width`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">built</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This model has not yet been built.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>  <span class="c1"># layer assumes channel first due to FFT</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bhwc-&gt;bchw&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

    <span class="n">inputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">rfft2d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">==</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">:</span>
        <span class="n">inputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span>
            <span class="n">inputs_f_domain</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># shift frequencies to be able to crop in center</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">inputs_f_domain</span><span class="p">)</span>
    <span class="n">outputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span>
        <span class="n">inputs_f_domain</span><span class="p">,</span>
        <span class="n">begin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset_width</span><span class="p">],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_width</span><span class="p">],</span>
    <span class="p">)</span>  <span class="c1"># Tf.slice instead of tf.image.crop, because the latter assumes channel last</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">==</span> <span class="n">FrequencyFilter</span><span class="o">.</span><span class="n">LOW_PASS</span><span class="p">:</span>
        <span class="n">outputs_f_domain</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">outputs_f_domain</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># reverse shift</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">irfft2d</span><span class="p">(</span><span class="n">outputs_f_domain</span><span class="p">)</span>

    <span class="c1"># reverse to previous channel config!</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">:</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;bchw-&gt;bhwc&quot;</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="DeepSaki.layers.pooling.rFFT2DFilter.get_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_config</span>


<a href="#DeepSaki.layers.pooling.rFFT2DFilter.get_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Serialization of the object.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the class' variable names as keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/pooling.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialization of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with the class&#39; variable names as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">rFFT2DFilter</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
    <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;is_channel_first&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_channel_first</span><span class="p">,</span> <span class="s2">&quot;filter_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>Collection of functions to simplify the code in various layers.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_helper.InitializerFunc" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">InitializerFunc</span>


<a href="#DeepSaki.layers.layer_helper.InitializerFunc" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p><code>Enum</code> used to define different types of initializer functions.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>RANDOM_NORMAL</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a random normal initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>RANDOM_UNIFORM</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a random uniform initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>GLOROT_NORMAL</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a Glorot normal initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>GLOROT_UNIFORM</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a Glorot uniform initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>HE_NORMAL</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a He normal initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>HE_UNIFORM</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a He uniform initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>HE_ALPHA_NORMAL</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a He Alpha normal initializer function.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>HE_ALPHA_UNIFORM</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Corresponds to a He Alpha Uniform initializer function.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.layer_helper.PaddingType" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PaddingType</span>


<a href="#DeepSaki.layers.layer_helper.PaddingType" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p><code>Enum</code> used to define different types of padding opperations.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ZERO</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates to apply a zero padding operations.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>REFLECTION</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Indicates to apply a reflection padding operation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.dropout_func" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">dropout_func</span>


<a href="#DeepSaki.layers.layer_helper.dropout_func" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">dropout_func</span><span class="p">(</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to obtain a dropout layer depending on the size of the preceeding feature map
args:
  - filters: number of filters of previous layer
  - dropout_rate: probability with which dropout is performed</p>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dropout_func</span><span class="p">(</span><span class="n">filters</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper to obtain a dropout layer depending on the size of the preceeding feature map</span>
<span class="sd">    args:</span>
<span class="sd">      - filters: number of filters of previous layer</span>
<span class="sd">      - dropout_rate: probability with which dropout is performed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filters</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpatialDropout2D</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout_rate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.get_initializer" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_initializer</span>


<a href="#DeepSaki.layers.layer_helper.get_initializer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">get_initializer</span><span class="p">(</span>
    <span class="n">initializer</span><span class="p">:</span> <span class="n">InitializerFunc</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to return a certain initializer given a descriptive string.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initializer</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.layer_helper.InitializerFunc" href="#DeepSaki.layers.layer_helper.InitializerFunc">InitializerFunc</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Enum description of the initializer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed to make the behavior of the initializer deterministic. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.initializers">initializers</span>.<span title="tensorflow.keras.initializers.Initializer">Initializer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Instance of an initializer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_initializer</span><span class="p">(</span><span class="n">initializer</span><span class="p">:</span> <span class="n">InitializerFunc</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to return a certain initializer given a descriptive string.</span>

<span class="sd">    Args:</span>
<span class="sd">        initializer (InitializerFunc): Enum description of the initializer.</span>
<span class="sd">        seed (Optional[int], optional): Seed to make the behavior of the initializer deterministic. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Instance of an initializer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">RANDOM_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomNormal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stddev</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">RANDOM_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">RandomUniform</span><span class="p">(</span><span class="n">minval</span><span class="o">=-</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">GLOROT_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">GLOROT_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_NORMAL</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">HeNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_UNIFORM</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">HeUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_ALPHA_NORMAL</span><span class="p">:</span> <span class="n">HeAlphaNormal</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
        <span class="n">InitializerFunc</span><span class="o">.</span><span class="n">HE_ALPHA_UNIFORM</span><span class="p">:</span> <span class="n">HeAlphaUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="k">assert</span> <span class="n">initializer</span> <span class="ow">in</span> <span class="n">valid_options</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Undefined initializer provided: </span><span class="si">{</span><span class="n">initializer</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">valid_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">initializer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.pad_func" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pad_func</span>


<a href="#DeepSaki.layers.layer_helper.pad_func" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">pad_func</span><span class="p">(</span>
    <span class="n">pad_values</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">padding_type</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Wrapper to obtain a padding layer instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pad_values</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the padding values. Defaults to (1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>padding_type</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.layer_helper.PaddingType" href="#DeepSaki.layers.layer_helper.PaddingType">PaddingType</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>[<em>description</em>]. Defaults to PaddingType.ZERO.</p>
            </div>
          </td>
          <td>
                <code><a class="autorefs autorefs-internal" title="DeepSaki.layers.layer_helper.PaddingType" href="#DeepSaki.layers.layer_helper.PaddingType">PaddingType</a>.<span title="DeepSaki.layers.layer_helper.PaddingType.ZERO">ZERO</span></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Instance of a padding layer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_func</span><span class="p">(</span>
    <span class="n">pad_values</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding_type</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to obtain a padding layer instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        pad_values (Tuple[int,int], optional): Size of the padding values. Defaults to (1, 1).</span>
<span class="sd">        padding_type (PaddingType, optional): [_description_]. Defaults to PaddingType.ZERO.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Instance of a padding layer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">PaddingType</span><span class="o">.</span><span class="n">REFLECTION</span><span class="p">:</span> <span class="n">ReflectionPadding2D</span><span class="p">(</span><span class="n">pad_values</span><span class="p">),</span>
        <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">ZeroPadding2D</span><span class="p">(</span><span class="n">pad_values</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">padding_type</span> <span class="ow">in</span> <span class="n">valid_options</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Undefined padding type provided: &#39;</span><span class="si">{</span><span class="n">padding_type</span><span class="si">}</span><span class="s2">&#39;. Valid options are: &#39;</span><span class="si">{</span><span class="n">valid_options</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="k">return</span> <span class="n">valid_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">padding_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="DeepSaki.layers.layer_helper.plot_layer" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">plot_layer</span>


<a href="#DeepSaki.layers.layer_helper.plot_layer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">plot_layer</span><span class="p">(</span>
    <span class="n">layer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
  
      <p>Creates an model from a given layer to be able to call model.summary() and to plot a graphic
args:
  layer: tf.keras.layer object to be ploted
  input_shape: shape of the input data without batchsize -&gt; (height, width, channel)</p>

          <details class="quote">
            <summary>Source code in <code>DeepSaki/layers/layer_helper.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an model from a given layer to be able to call model.summary() and to plot a graphic</span>
<span class="sd">    args:</span>
<span class="sd">      layer: tf.keras.layer object to be ploted</span>
<span class="sd">      input_shape: shape of the input data without batchsize -&gt; (height, width, channel)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">input_shape</span><span class="p">])</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">inputs</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand_nested</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">to_file</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Bottleneck" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Bottleneck</span>


<a href="#DeepSaki.layers.sub_model_composites.Bottleneck" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Bottleneck</span><span class="p">(</span>
    <span class="n">n_bottleneck_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Bottlenecks are sub-model blocks in auto-encoder-like models such as UNet or ResNet. It is composed of multiple convolution blocks which might have residuals
args:
  - n_bottleneck_blocks (optional, default: 3): Number of consecutive convolution blocks
  - kernels: size of the convolutions kernels
  - split_kernels (optional, default: False): to decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly
  - number_of_convs (optional, default: 2): number of consecutive convolutional building blocks, i.e. Conv2DBlock.
  - use_residual_Conv2DBlock (optional, default: True): ads a residual connection in parallel to the Conv2DBlock
  - useResidualIdentityBlock (optional, default: False): Whether or not to use the ResidualIdentityBlock instead of the Conv2DBlock
  - activation (optional, default: "leaky_relu"): string literal or tensorflow activation function object to obtain activation function
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout
  - channelList (optional, default:None): alternativly to number_of_layers and filters, a list with the disired filters for each block can be provided. e.g. channel_list = [64, 128, 256] results in a 3-staged Bottleneck with 64, 128, 256 filters for stage 1, 2 and 3 respectivly.
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - residual_cardinality (optional, default: 1): cardinality for the ResidualIdentityBlock
  - padding (optional, default: "none"): padding type. Options are "none", "zero" or "reflection"
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n_bottleneck_blocks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Bottleneck</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useResidualIdentityBlock</span> <span class="o">=</span> <span class="n">useResidualIdentityBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_bottleneck_blocks</span> <span class="o">=</span> <span class="n">n_bottleneck_blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_residual_Conv2DBlock</span> <span class="o">=</span> <span class="n">use_residual_Conv2DBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_convs</span> <span class="o">=</span> <span class="n">number_of_convs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channelList</span> <span class="o">=</span> <span class="n">channelList</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Decoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Decoder</span>


<a href="#DeepSaki.layers.sub_model_composites.Decoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Decoder</span><span class="p">(</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2D_upsample_and_conv&quot;</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">useSelfAttention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enableSkipConnectionsInput</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Decoder sub-model combines convolutional blocks with up sample blocks. The spatial width is double with every level while the channel depth is halfed.
args:
  - number_of_levels (optional, default:3): number of conv2D -&gt; Upsampling pairs
  - upsampling(optional, default: "2D_upsample_and_conv"): describes the upsampling method used
  - filters (optional, default:64): defines the number of filters to which the input is exposed.
  - limit_filters (optional, default:1024): limits the number of filters
  - use_residual_Conv2DBlock (optional, default: False): ads a residual connection in parallel to the Conv2DBlock
  - kernels: size of the convolutions kernels
  - split_kernels (optional, default: False): to decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly
  - number_of_convs (optional, default: 1): number of consecutive convolutional building blocks, i.e. Conv2DBlock.
  - activation (optional, default: "leaky_relu"): string literal or tensorflow activation function object to obtain activation function
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout. In the decoder only applied to the first half of levels.
  - useResidualIdentityBlock (optional, default: False): Whether or not to use the ResidualIdentityBlock instead of the Conv2DBlock
  - residual_cardinality (optional, default: 1): cardinality for the ResidualIdentityBlock
  - channelList (optional, default:None): alternativly to number_of_layers and filters, a list with the disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level Decoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly.
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - useSelfAttention (optional, default: False): Determines whether to apply self-attention after the encoder before branching.
  - enableSkipConnectionsInput (optional, default: False): Whether or not to input skip connections at each level
  - padding (optional, default: "none"): padding type. Options are "none", "zero" or "reflection"
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">upsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2D_upsample_and_conv&quot;</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">useSelfAttention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enableSkipConnectionsInput</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Decoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="n">number_of_levels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">=</span> <span class="n">upsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span> <span class="o">=</span> <span class="n">limit_filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_residual_Conv2DBlock</span> <span class="o">=</span> <span class="n">use_residual_Conv2DBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_convs</span> <span class="o">=</span> <span class="n">number_of_convs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useResidualIdentityBlock</span> <span class="o">=</span> <span class="n">useResidualIdentityBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channelList</span> <span class="o">=</span> <span class="n">channelList</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useSelfAttention</span> <span class="o">=</span> <span class="n">useSelfAttention</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enableSkipConnectionsInput</span> <span class="o">=</span> <span class="n">enableSkipConnectionsInput</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h2 id="DeepSaki.layers.sub_model_composites.Encoder" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Encoder</span>


<a href="#DeepSaki.layers.sub_model_composites.Encoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Encoder</span><span class="p">(</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conv_stride_2&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">first_kernel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">useSelfAttention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">omit_skips</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">outputSkips</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow">tf</span>.<span title="tensorflow.keras">keras</span>.<span title="tensorflow.keras.layers">layers</span>.<span title="tensorflow.keras.layers.Layer">Layer</span></code></p>

  
      <p>Encoder sub-model combines convolutional blocks with down sample blocks. The spatial width is halfed with every level while the channel depth is doubled.
args:
  - number_of_levels (optional, default:3): number of conv2D -&gt; Downsampling pairs
  - filters (optional, default:64): defines the number of filters to which the input is exposed.
  - kernels: size of the convolutions kernels
  - limit_filters (optional, default:1024): limits the number of filters, which is doubled with every downsampling block
  - use_residual_Conv2DBlock (optional, default: False): ads a residual connection in parallel to the Conv2DBlock
  - downsampling(optional, default: "conv_stride_2"): describes the downsampling method used
  - split_kernels (optional, default: False): to decrease the number of parameters, a convolution with the kernel_size (kernel,kernel) can be splitted into two consecutive convolutions with the kernel_size (kernel,1) and (1,kernel) respectivly
  - number_of_convs (optional, default: 1): number of consecutive convolutional building blocks, i.e. Conv2DBlock.
  - activation (optional, default: "leaky_relu"): string literal or tensorflow activation function object to obtain activation function
  - first_kernel (optional, default: 5): The first convolution can have a different kernel size, to e.g. increase the perceptive field, while the channel depth is still low.
  - useResidualIdentityBlock (optional, default: False): Whether or not to use the ResidualIdentityBlock instead of the Conv2DBlock
  - residual_cardinality (optional, default: 1): cardinality for the ResidualIdentityBlock
  - channelList (optional, default:None): alternativly to number_of_layers and filters, a list with the disired filters for each level can be provided. e.g. channel_list = [64, 128, 256] results in a 3-level Encoder with 64, 128, 256 filters for level 1, 2 and 3 respectivly.
  - use_spec_norm (optional, default: False): applies spectral normalization to convolutional and dense layers
  - use_bias (optional, default: True): determines whether convolutions and dense layers include a bias or not
  - dropout_rate (optional, default: 0): probability of the dropout layer. If the preceeding layer has more than one channel, spatial dropout is applied, otherwise standard dropout
  - useSelfAttention (optional, default: False): Determines whether to apply self-attention after the encoder before branching.
  - omit_skips (optional, default: 0): defines how many layers should not output a skip connection output. Requires outputSkips to be True. E.g. if omit_skips = 2, the first two levels do not output a skip connection, it starts at level 3.
  - padding (optional, default: "none"): padding type. Options are "none", "zero" or "reflection"
  - outputSkips (optional, default: False): Whether or not to output skip connections at each level
  - kernel_initializer (optional, default: HeAlphaUniform()): Initialization of the convolutions kernels.
  - gamma_initializer (optional, default: HeAlphaUniform()): Initialization of the normalization layers.</p>

                <details class="quote">
                  <summary>Source code in <code>DeepSaki/layers/sub_model_composites.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="n">limit_filters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="n">use_residual_Conv2DBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">downsampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conv_stride_2&quot;</span><span class="p">,</span>
    <span class="n">kernels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">split_kernels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">number_of_convs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;leaky_relu&quot;</span><span class="p">,</span>
    <span class="n">first_kernel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">useResidualIdentityBlock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">residual_cardinality</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">channelList</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_spec_norm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dropout_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">useSelfAttention</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">omit_skips</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">:</span> <span class="n">PaddingType</span> <span class="o">=</span> <span class="n">PaddingType</span><span class="o">.</span><span class="n">ZERO</span><span class="p">,</span>
    <span class="n">outputSkips</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">kernel_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
    <span class="n">gamma_initializer</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Initializer</span> <span class="o">=</span> <span class="n">HeAlphaUniform</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_levels</span> <span class="o">=</span> <span class="n">number_of_levels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filters</span> <span class="o">=</span> <span class="n">filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limit_filters</span> <span class="o">=</span> <span class="n">limit_filters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_residual_Conv2DBlock</span> <span class="o">=</span> <span class="n">use_residual_Conv2DBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">downsampling</span> <span class="o">=</span> <span class="n">downsampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernels</span> <span class="o">=</span> <span class="n">kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">split_kernels</span> <span class="o">=</span> <span class="n">split_kernels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_of_convs</span> <span class="o">=</span> <span class="n">number_of_convs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">first_kernel</span> <span class="o">=</span> <span class="n">first_kernel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useResidualIdentityBlock</span> <span class="o">=</span> <span class="n">useResidualIdentityBlock</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residual_cardinality</span> <span class="o">=</span> <span class="n">residual_cardinality</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channelList</span> <span class="o">=</span> <span class="n">channelList</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spec_norm</span> <span class="o">=</span> <span class="n">use_spec_norm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">useSelfAttention</span> <span class="o">=</span> <span class="n">useSelfAttention</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">omit_skips</span> <span class="o">=</span> <span class="n">omit_skips</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outputSkips</span> <span class="o">=</span> <span class="n">outputSkips</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_bias</span> <span class="o">=</span> <span class="n">use_bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">kernel_initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gamma_initializer</span> <span class="o">=</span> <span class="n">gamma_initializer</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../initializers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: initializers">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                initializers
              </div>
            </div>
          </a>
        
        
          
          <a href="../loss/" class="md-footer__link md-footer__link--next" aria-label="Next: loss">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                loss
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://sascha-kirch.github.io/" target="_blank" rel="noopener" title="sascha-kirch.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 8C119.252 8 8 119.252 8 256s111.252 248 248 248 248-111.252 248-248S392.748 8 256 8zm163.97 114.366c29.503 36.046 47.369 81.957 47.835 131.955-6.984-1.477-77.018-15.682-147.502-6.818-5.752-14.041-11.181-26.393-18.617-41.614 78.321-31.977 113.818-77.482 118.284-83.523zM396.421 97.87c-3.81 5.427-35.697 48.286-111.021 76.519-34.712-63.776-73.185-116.168-79.04-124.008 67.176-16.193 137.966 1.27 190.061 47.489zm-230.48-33.25c5.585 7.659 43.438 60.116 78.537 122.509-99.087 26.313-186.36 25.934-195.834 25.809C62.38 147.205 106.678 92.573 165.941 64.62zM44.17 256.323c0-2.166.043-4.322.108-6.473 9.268.19 111.92 1.513 217.706-30.146 6.064 11.868 11.857 23.915 17.174 35.949-76.599 21.575-146.194 83.527-180.531 142.306C64.794 360.405 44.17 310.73 44.17 256.323zm81.807 167.113c22.127-45.233 82.178-103.622 167.579-132.756 29.74 77.283 42.039 142.053 45.189 160.638-68.112 29.013-150.015 21.053-212.768-27.882zm248.38 8.489c-2.171-12.886-13.446-74.897-41.152-151.033 66.38-10.626 124.7 6.768 131.947 9.055-9.442 58.941-43.273 109.844-90.795 141.978z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/sascha-kirch/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/sascha-kirch" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@SaschaKirch" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.path", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>